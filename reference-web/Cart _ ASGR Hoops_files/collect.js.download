(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n=0,F=function F(){};return{s:F,n:function n(){return _n>=r.length?{done:!0}:{done:!1,value:r[_n++]}},e:function e(r){throw r},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function s(){t=t.call(r)},n:function n(){var r=t.next();return a=r.done,r},e:function e(r){u=!0,o=r},f:function f(){try{a||null==t["return"]||t["return"]()}finally{if(u)throw o}}}}function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,e);var p=new(t.bind.apply(t,o));return r&&_setPrototypeOf(p,r.prototype),p}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}(function(global,factory){(typeof exports==="undefined"?"undefined":_typeof(exports))==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):(global=typeof globalThis!=="undefined"?globalThis:global||self,global.DOMPurify=factory())})(void 0,function(){"use strict";var entries=Object.entries,setPrototypeOf=Object.setPrototypeOf,isFrozen=Object.isFrozen,getPrototypeOf=Object.getPrototypeOf,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;var freeze=Object.freeze,seal=Object.seal,create=Object.create;var _ref=typeof Reflect!=="undefined"&&Reflect,apply=_ref.apply,construct=_ref.construct;if(!freeze){freeze=function freeze(x){return x}}if(!seal){seal=function seal(x){return x}}if(!apply){apply=function apply(fun,thisValue,args){return fun.apply(thisValue,args)}}if(!construct){construct=function construct(Func,args){return _construct(Func,_toConsumableArray(args))}}var arrayForEach=unapply(Array.prototype.forEach);var arrayLastIndexOf=unapply(Array.prototype.lastIndexOf);var arrayPop=unapply(Array.prototype.pop);var arrayPush=unapply(Array.prototype.push);var arraySplice=unapply(Array.prototype.splice);var stringToLowerCase=unapply(String.prototype.toLowerCase);var stringToString=unapply(String.prototype.toString);var stringMatch=unapply(String.prototype.match);var stringReplace=unapply(String.prototype.replace);var stringIndexOf=unapply(String.prototype.indexOf);var stringTrim=unapply(String.prototype.trim);var objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty);var regExpTest=unapply(RegExp.prototype.test);var typeErrorCreate=unconstruct(TypeError);function unapply(func){return function(thisArg){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}return apply(func,thisArg,args)}}function unconstruct(func){return function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}return construct(func,args)}}function addToSet(set,array){var transformCaseFunc=arguments.length>2&&arguments[2]!==undefined?arguments[2]:stringToLowerCase;if(setPrototypeOf){setPrototypeOf(set,null)}var l=array.length;while(l--){var element=array[l];if(typeof element==="string"){var lcElement=transformCaseFunc(element);if(lcElement!==element){if(!isFrozen(array)){array[l]=lcElement}element=lcElement}}set[element]=true}return set}function cleanArray(array){for(var index=0;index<array.length;index++){var isPropertyExist=objectHasOwnProperty(array,index);if(!isPropertyExist){array[index]=null}}return array}function clone(object){var newObject=create(null);var _iterator=_createForOfIteratorHelper(entries(object)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),property=_step$value[0],value=_step$value[1];var isPropertyExist=objectHasOwnProperty(object,property);if(isPropertyExist){if(Array.isArray(value)){newObject[property]=cleanArray(value)}else if(value&&_typeof(value)==="object"&&value.constructor===Object){newObject[property]=clone(value)}else{newObject[property]=value}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return newObject}function lookupGetter(object,prop){while(object!==null){var desc=getOwnPropertyDescriptor(object,prop);if(desc){if(desc.get){return unapply(desc.get)}if(typeof desc.value==="function"){return unapply(desc.value)}}object=getPrototypeOf(object)}function fallbackValue(){return null}return fallbackValue}var html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]);var svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]);var svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]);var svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]);var mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]);var mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]);var text=freeze(["#text"]);var html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]);var svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]);var mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]);var xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]);var MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm);var ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm);var TMPLIT_EXPR=seal(/\$\{[\w\W]*/gm);var DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/);var ARIA_ATTR=seal(/^aria-[\-\w]+$/);var IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i);var IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i);var ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g);var DOCTYPE_NAME=seal(/^html$/i);var CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR:ARIA_ATTR,ATTR_WHITESPACE:ATTR_WHITESPACE,CUSTOM_ELEMENT:CUSTOM_ELEMENT,DATA_ATTR:DATA_ATTR,DOCTYPE_NAME:DOCTYPE_NAME,ERB_EXPR:ERB_EXPR,IS_ALLOWED_URI:IS_ALLOWED_URI,IS_SCRIPT_OR_DATA:IS_SCRIPT_OR_DATA,MUSTACHE_EXPR:MUSTACHE_EXPR,TMPLIT_EXPR:TMPLIT_EXPR});var NODE_TYPE={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12};var getGlobal=function getGlobal(){return typeof window==="undefined"?null:window};var _createTrustedTypesPolicy=function _createTrustedTypesPolicy(trustedTypes,purifyHostElement){if(_typeof(trustedTypes)!=="object"||typeof trustedTypes.createPolicy!=="function"){return null}var suffix=null;var ATTR_NAME="data-tt-policy-suffix";if(purifyHostElement&&purifyHostElement.hasAttribute(ATTR_NAME)){suffix=purifyHostElement.getAttribute(ATTR_NAME)}var policyName="dompurify"+(suffix?"#"+suffix:"");try{return trustedTypes.createPolicy(policyName,{createHTML:function createHTML(html){return html},createScriptURL:function createScriptURL(scriptUrl){return scriptUrl}})}catch(_){console.warn("TrustedTypes policy "+policyName+" could not be created.");return null}};var _createHooksMap=function _createHooksMap(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){var window=arguments.length>0&&arguments[0]!==undefined?arguments[0]:getGlobal();var DOMPurify=function DOMPurify(root){return createDOMPurify(root)};DOMPurify.version="3.2.4";DOMPurify.removed=[];if(!window||!window.document||window.document.nodeType!==NODE_TYPE.document||!window.Element){DOMPurify.isSupported=false;return DOMPurify}var document=window.document;var originalDocument=document;var currentScript=originalDocument.currentScript;var DocumentFragment=window.DocumentFragment,HTMLTemplateElement=window.HTMLTemplateElement,Node=window.Node,Element=window.Element,NodeFilter=window.NodeFilter,_window$NamedNodeMap=window.NamedNodeMap,NamedNodeMap=_window$NamedNodeMap===void 0?window.NamedNodeMap||window.MozNamedAttrMap:_window$NamedNodeMap,HTMLFormElement=window.HTMLFormElement,DOMParser=window.DOMParser,trustedTypes=window.trustedTypes;var ElementPrototype=Element.prototype;var cloneNode=lookupGetter(ElementPrototype,"cloneNode");var remove=lookupGetter(ElementPrototype,"remove");var getNextSibling=lookupGetter(ElementPrototype,"nextSibling");var getChildNodes=lookupGetter(ElementPrototype,"childNodes");var getParentNode=lookupGetter(ElementPrototype,"parentNode");if(typeof HTMLTemplateElement==="function"){var template=document.createElement("template");if(template.content&&template.content.ownerDocument){document=template.content.ownerDocument}}var trustedTypesPolicy;var emptyHTML="";var _document=document,implementation=_document.implementation,createNodeIterator=_document.createNodeIterator,createDocumentFragment=_document.createDocumentFragment,getElementsByTagName=_document.getElementsByTagName;var importNode=originalDocument.importNode;var hooks=_createHooksMap();DOMPurify.isSupported=typeof entries==="function"&&typeof getParentNode==="function"&&implementation&&implementation.createHTMLDocument!==undefined;var MUSTACHE_EXPR=EXPRESSIONS.MUSTACHE_EXPR,ERB_EXPR=EXPRESSIONS.ERB_EXPR,TMPLIT_EXPR=EXPRESSIONS.TMPLIT_EXPR,DATA_ATTR=EXPRESSIONS.DATA_ATTR,ARIA_ATTR=EXPRESSIONS.ARIA_ATTR,IS_SCRIPT_OR_DATA=EXPRESSIONS.IS_SCRIPT_OR_DATA,ATTR_WHITESPACE=EXPRESSIONS.ATTR_WHITESPACE,CUSTOM_ELEMENT=EXPRESSIONS.CUSTOM_ELEMENT;var IS_ALLOWED_URI$1=EXPRESSIONS.IS_ALLOWED_URI;var ALLOWED_TAGS=null;var DEFAULT_ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray(html$1),_toConsumableArray(svg$1),_toConsumableArray(svgFilters),_toConsumableArray(mathMl$1),_toConsumableArray(text)));var ALLOWED_ATTR=null;var DEFAULT_ALLOWED_ATTR=addToSet({},[].concat(_toConsumableArray(html),_toConsumableArray(svg),_toConsumableArray(mathMl),_toConsumableArray(xml)));var CUSTOM_ELEMENT_HANDLING=Object.seal(create(null,{tagNameCheck:{writable:true,configurable:false,enumerable:true,value:null},attributeNameCheck:{writable:true,configurable:false,enumerable:true,value:null},allowCustomizedBuiltInElements:{writable:true,configurable:false,enumerable:true,value:false}}));var FORBID_TAGS=null;var FORBID_ATTR=null;var ALLOW_ARIA_ATTR=true;var ALLOW_DATA_ATTR=true;var ALLOW_UNKNOWN_PROTOCOLS=false;var ALLOW_SELF_CLOSE_IN_ATTR=true;var SAFE_FOR_TEMPLATES=false;var SAFE_FOR_XML=true;var WHOLE_DOCUMENT=false;var SET_CONFIG=false;var FORCE_BODY=false;var RETURN_DOM=false;var RETURN_DOM_FRAGMENT=false;var RETURN_TRUSTED_TYPE=false;var SANITIZE_DOM=true;var SANITIZE_NAMED_PROPS=false;var SANITIZE_NAMED_PROPS_PREFIX="user-content-";var KEEP_CONTENT=true;var IN_PLACE=false;var USE_PROFILES={};var FORBID_CONTENTS=null;var DEFAULT_FORBID_CONTENTS=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);var DATA_URI_TAGS=null;var DEFAULT_DATA_URI_TAGS=addToSet({},["audio","video","img","source","image","track"]);var URI_SAFE_ATTRIBUTES=null;var DEFAULT_URI_SAFE_ATTRIBUTES=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]);var MATHML_NAMESPACE="http://www.w3.org/1998/Math/MathML";var SVG_NAMESPACE="http://www.w3.org/2000/svg";var HTML_NAMESPACE="http://www.w3.org/1999/xhtml";var NAMESPACE=HTML_NAMESPACE;var IS_EMPTY_INPUT=false;var ALLOWED_NAMESPACES=null;var DEFAULT_ALLOWED_NAMESPACES=addToSet({},[MATHML_NAMESPACE,SVG_NAMESPACE,HTML_NAMESPACE],stringToString);var MATHML_TEXT_INTEGRATION_POINTS=addToSet({},["mi","mo","mn","ms","mtext"]);var HTML_INTEGRATION_POINTS=addToSet({},["annotation-xml"]);var COMMON_SVG_AND_HTML_ELEMENTS=addToSet({},["title","style","font","a","script"]);var PARSER_MEDIA_TYPE=null;var SUPPORTED_PARSER_MEDIA_TYPES=["application/xhtml+xml","text/html"];var DEFAULT_PARSER_MEDIA_TYPE="text/html";var transformCaseFunc=null;var CONFIG=null;var formElement=document.createElement("form");var isRegexOrFunction=function isRegexOrFunction(testValue){return testValue instanceof RegExp||testValue instanceof Function};var _parseConfig=function _parseConfig(){var cfg=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(CONFIG&&CONFIG===cfg){return}if(!cfg||_typeof(cfg)!=="object"){cfg={}}cfg=clone(cfg);PARSER_MEDIA_TYPE=SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE)===-1?DEFAULT_PARSER_MEDIA_TYPE:cfg.PARSER_MEDIA_TYPE;transformCaseFunc=PARSER_MEDIA_TYPE==="application/xhtml+xml"?stringToString:stringToLowerCase;ALLOWED_TAGS=objectHasOwnProperty(cfg,"ALLOWED_TAGS")?addToSet({},cfg.ALLOWED_TAGS,transformCaseFunc):DEFAULT_ALLOWED_TAGS;ALLOWED_ATTR=objectHasOwnProperty(cfg,"ALLOWED_ATTR")?addToSet({},cfg.ALLOWED_ATTR,transformCaseFunc):DEFAULT_ALLOWED_ATTR;ALLOWED_NAMESPACES=objectHasOwnProperty(cfg,"ALLOWED_NAMESPACES")?addToSet({},cfg.ALLOWED_NAMESPACES,stringToString):DEFAULT_ALLOWED_NAMESPACES;URI_SAFE_ATTRIBUTES=objectHasOwnProperty(cfg,"ADD_URI_SAFE_ATTR")?addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES),cfg.ADD_URI_SAFE_ATTR,transformCaseFunc):DEFAULT_URI_SAFE_ATTRIBUTES;DATA_URI_TAGS=objectHasOwnProperty(cfg,"ADD_DATA_URI_TAGS")?addToSet(clone(DEFAULT_DATA_URI_TAGS),cfg.ADD_DATA_URI_TAGS,transformCaseFunc):DEFAULT_DATA_URI_TAGS;FORBID_CONTENTS=objectHasOwnProperty(cfg,"FORBID_CONTENTS")?addToSet({},cfg.FORBID_CONTENTS,transformCaseFunc):DEFAULT_FORBID_CONTENTS;FORBID_TAGS=objectHasOwnProperty(cfg,"FORBID_TAGS")?addToSet({},cfg.FORBID_TAGS,transformCaseFunc):{};FORBID_ATTR=objectHasOwnProperty(cfg,"FORBID_ATTR")?addToSet({},cfg.FORBID_ATTR,transformCaseFunc):{};USE_PROFILES=objectHasOwnProperty(cfg,"USE_PROFILES")?cfg.USE_PROFILES:false;ALLOW_ARIA_ATTR=cfg.ALLOW_ARIA_ATTR!==false;ALLOW_DATA_ATTR=cfg.ALLOW_DATA_ATTR!==false;ALLOW_UNKNOWN_PROTOCOLS=cfg.ALLOW_UNKNOWN_PROTOCOLS||false;ALLOW_SELF_CLOSE_IN_ATTR=cfg.ALLOW_SELF_CLOSE_IN_ATTR!==false;SAFE_FOR_TEMPLATES=cfg.SAFE_FOR_TEMPLATES||false;SAFE_FOR_XML=cfg.SAFE_FOR_XML!==false;WHOLE_DOCUMENT=cfg.WHOLE_DOCUMENT||false;RETURN_DOM=cfg.RETURN_DOM||false;RETURN_DOM_FRAGMENT=cfg.RETURN_DOM_FRAGMENT||false;RETURN_TRUSTED_TYPE=cfg.RETURN_TRUSTED_TYPE||false;FORCE_BODY=cfg.FORCE_BODY||false;SANITIZE_DOM=cfg.SANITIZE_DOM!==false;SANITIZE_NAMED_PROPS=cfg.SANITIZE_NAMED_PROPS||false;KEEP_CONTENT=cfg.KEEP_CONTENT!==false;IN_PLACE=cfg.IN_PLACE||false;IS_ALLOWED_URI$1=cfg.ALLOWED_URI_REGEXP||IS_ALLOWED_URI;NAMESPACE=cfg.NAMESPACE||HTML_NAMESPACE;MATHML_TEXT_INTEGRATION_POINTS=cfg.MATHML_TEXT_INTEGRATION_POINTS||MATHML_TEXT_INTEGRATION_POINTS;HTML_INTEGRATION_POINTS=cfg.HTML_INTEGRATION_POINTS||HTML_INTEGRATION_POINTS;CUSTOM_ELEMENT_HANDLING=cfg.CUSTOM_ELEMENT_HANDLING||{};if(cfg.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)){CUSTOM_ELEMENT_HANDLING.tagNameCheck=cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck}if(cfg.CUSTOM_ELEMENT_HANDLING&&isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)){CUSTOM_ELEMENT_HANDLING.attributeNameCheck=cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck}if(cfg.CUSTOM_ELEMENT_HANDLING&&typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements==="boolean"){CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements}if(SAFE_FOR_TEMPLATES){ALLOW_DATA_ATTR=false}if(RETURN_DOM_FRAGMENT){RETURN_DOM=true}if(USE_PROFILES){ALLOWED_TAGS=addToSet({},text);ALLOWED_ATTR=[];if(USE_PROFILES.html===true){addToSet(ALLOWED_TAGS,html$1);addToSet(ALLOWED_ATTR,html)}if(USE_PROFILES.svg===true){addToSet(ALLOWED_TAGS,svg$1);addToSet(ALLOWED_ATTR,svg);addToSet(ALLOWED_ATTR,xml)}if(USE_PROFILES.svgFilters===true){addToSet(ALLOWED_TAGS,svgFilters);addToSet(ALLOWED_ATTR,svg);addToSet(ALLOWED_ATTR,xml)}if(USE_PROFILES.mathMl===true){addToSet(ALLOWED_TAGS,mathMl$1);addToSet(ALLOWED_ATTR,mathMl);addToSet(ALLOWED_ATTR,xml)}}if(cfg.ADD_TAGS){if(ALLOWED_TAGS===DEFAULT_ALLOWED_TAGS){ALLOWED_TAGS=clone(ALLOWED_TAGS)}addToSet(ALLOWED_TAGS,cfg.ADD_TAGS,transformCaseFunc)}if(cfg.ADD_ATTR){if(ALLOWED_ATTR===DEFAULT_ALLOWED_ATTR){ALLOWED_ATTR=clone(ALLOWED_ATTR)}addToSet(ALLOWED_ATTR,cfg.ADD_ATTR,transformCaseFunc)}if(cfg.ADD_URI_SAFE_ATTR){addToSet(URI_SAFE_ATTRIBUTES,cfg.ADD_URI_SAFE_ATTR,transformCaseFunc)}if(cfg.FORBID_CONTENTS){if(FORBID_CONTENTS===DEFAULT_FORBID_CONTENTS){FORBID_CONTENTS=clone(FORBID_CONTENTS)}addToSet(FORBID_CONTENTS,cfg.FORBID_CONTENTS,transformCaseFunc)}if(KEEP_CONTENT){ALLOWED_TAGS["#text"]=true}if(WHOLE_DOCUMENT){addToSet(ALLOWED_TAGS,["html","head","body"])}if(ALLOWED_TAGS.table){addToSet(ALLOWED_TAGS,["tbody"]);delete FORBID_TAGS.tbody}if(cfg.TRUSTED_TYPES_POLICY){if(typeof cfg.TRUSTED_TYPES_POLICY.createHTML!=="function"){throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.')}if(typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL!=="function"){throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.')}trustedTypesPolicy=cfg.TRUSTED_TYPES_POLICY;emptyHTML=trustedTypesPolicy.createHTML("")}else{if(trustedTypesPolicy===undefined){trustedTypesPolicy=_createTrustedTypesPolicy(trustedTypes,currentScript)}if(trustedTypesPolicy!==null&&typeof emptyHTML==="string"){emptyHTML=trustedTypesPolicy.createHTML("")}}if(freeze){freeze(cfg)}CONFIG=cfg};var ALL_SVG_TAGS=addToSet({},[].concat(_toConsumableArray(svg$1),_toConsumableArray(svgFilters),_toConsumableArray(svgDisallowed)));var ALL_MATHML_TAGS=addToSet({},[].concat(_toConsumableArray(mathMl$1),_toConsumableArray(mathMlDisallowed)));var _checkValidNamespace=function _checkValidNamespace(element){var parent=getParentNode(element);if(!parent||!parent.tagName){parent={namespaceURI:NAMESPACE,tagName:"template"}}var tagName=stringToLowerCase(element.tagName);var parentTagName=stringToLowerCase(parent.tagName);if(!ALLOWED_NAMESPACES[element.namespaceURI]){return false}if(element.namespaceURI===SVG_NAMESPACE){if(parent.namespaceURI===HTML_NAMESPACE){return tagName==="svg"}if(parent.namespaceURI===MATHML_NAMESPACE){return tagName==="svg"&&(parentTagName==="annotation-xml"||MATHML_TEXT_INTEGRATION_POINTS[parentTagName])}return Boolean(ALL_SVG_TAGS[tagName])}if(element.namespaceURI===MATHML_NAMESPACE){if(parent.namespaceURI===HTML_NAMESPACE){return tagName==="math"}if(parent.namespaceURI===SVG_NAMESPACE){return tagName==="math"&&HTML_INTEGRATION_POINTS[parentTagName]}return Boolean(ALL_MATHML_TAGS[tagName])}if(element.namespaceURI===HTML_NAMESPACE){if(parent.namespaceURI===SVG_NAMESPACE&&!HTML_INTEGRATION_POINTS[parentTagName]){return false}if(parent.namespaceURI===MATHML_NAMESPACE&&!MATHML_TEXT_INTEGRATION_POINTS[parentTagName]){return false}return!ALL_MATHML_TAGS[tagName]&&(COMMON_SVG_AND_HTML_ELEMENTS[tagName]||!ALL_SVG_TAGS[tagName])}if(PARSER_MEDIA_TYPE==="application/xhtml+xml"&&ALLOWED_NAMESPACES[element.namespaceURI]){return true}return false};var _forceRemove=function _forceRemove(node){arrayPush(DOMPurify.removed,{element:node});try{getParentNode(node).removeChild(node)}catch(_){remove(node)}};var _removeAttribute=function _removeAttribute(name,element){try{arrayPush(DOMPurify.removed,{attribute:element.getAttributeNode(name),from:element})}catch(_){arrayPush(DOMPurify.removed,{attribute:null,from:element})}element.removeAttribute(name);if(name==="is"){if(RETURN_DOM||RETURN_DOM_FRAGMENT){try{_forceRemove(element)}catch(_){}}else{try{element.setAttribute(name,"")}catch(_){}}}};var _initDocument=function _initDocument(dirty){var doc=null;var leadingWhitespace=null;if(FORCE_BODY){dirty="<remove></remove>"+dirty}else{var matches=stringMatch(dirty,/^[\r\n\t ]+/);leadingWhitespace=matches&&matches[0]}if(PARSER_MEDIA_TYPE==="application/xhtml+xml"&&NAMESPACE===HTML_NAMESPACE){dirty='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+dirty+"</body></html>"}var dirtyPayload=trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;if(NAMESPACE===HTML_NAMESPACE){try{doc=(new DOMParser).parseFromString(dirtyPayload,PARSER_MEDIA_TYPE)}catch(_){}}if(!doc||!doc.documentElement){doc=implementation.createDocument(NAMESPACE,"template",null);try{doc.documentElement.innerHTML=IS_EMPTY_INPUT?emptyHTML:dirtyPayload}catch(_){}}var body=doc.body||doc.documentElement;if(dirty&&leadingWhitespace){body.insertBefore(document.createTextNode(leadingWhitespace),body.childNodes[0]||null)}if(NAMESPACE===HTML_NAMESPACE){return getElementsByTagName.call(doc,WHOLE_DOCUMENT?"html":"body")[0]}return WHOLE_DOCUMENT?doc.documentElement:body};var _createNodeIterator=function _createNodeIterator(root){return createNodeIterator.call(root.ownerDocument||root,root,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT|NodeFilter.SHOW_PROCESSING_INSTRUCTION|NodeFilter.SHOW_CDATA_SECTION,null)};var _isClobbered=function _isClobbered(element){return element instanceof HTMLFormElement&&(typeof element.nodeName!=="string"||typeof element.textContent!=="string"||typeof element.removeChild!=="function"||!(element.attributes instanceof NamedNodeMap)||typeof element.removeAttribute!=="function"||typeof element.setAttribute!=="function"||typeof element.namespaceURI!=="string"||typeof element.insertBefore!=="function"||typeof element.hasChildNodes!=="function")};var _isNode=function _isNode(value){return typeof Node==="function"&&value instanceof Node};function _executeHooks(hooks,currentNode,data){arrayForEach(hooks,function(hook){hook.call(DOMPurify,currentNode,data,CONFIG)})}var _sanitizeElements=function _sanitizeElements(currentNode){var content=null;_executeHooks(hooks.beforeSanitizeElements,currentNode,null);if(_isClobbered(currentNode)){_forceRemove(currentNode);return true}var tagName=transformCaseFunc(currentNode.nodeName);_executeHooks(hooks.uponSanitizeElement,currentNode,{tagName:tagName,allowedTags:ALLOWED_TAGS});if(currentNode.hasChildNodes()&&!_isNode(currentNode.firstElementChild)&&regExpTest(/<[/\w]/g,currentNode.innerHTML)&&regExpTest(/<[/\w]/g,currentNode.textContent)){_forceRemove(currentNode);return true}if(currentNode.nodeType===NODE_TYPE.progressingInstruction){_forceRemove(currentNode);return true}if(SAFE_FOR_XML&&currentNode.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,currentNode.data)){_forceRemove(currentNode);return true}if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){if(!FORBID_TAGS[tagName]&&_isBasicCustomElement(tagName)){if(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,tagName)){return false}if(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)){return false}}if(KEEP_CONTENT&&!FORBID_CONTENTS[tagName]){var parentNode=getParentNode(currentNode)||currentNode.parentNode;var childNodes=getChildNodes(currentNode)||currentNode.childNodes;if(childNodes&&parentNode){var childCount=childNodes.length;for(var i=childCount-1;i>=0;--i){var childClone=cloneNode(childNodes[i],true);childClone.__removalCount=(currentNode.__removalCount||0)+1;parentNode.insertBefore(childClone,getNextSibling(currentNode))}}}_forceRemove(currentNode);return true}if(currentNode instanceof Element&&!_checkValidNamespace(currentNode)){_forceRemove(currentNode);return true}if((tagName==="noscript"||tagName==="noembed"||tagName==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,currentNode.innerHTML)){_forceRemove(currentNode);return true}if(SAFE_FOR_TEMPLATES&&currentNode.nodeType===NODE_TYPE.text){content=currentNode.textContent;arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],function(expr){content=stringReplace(content,expr," ")});if(currentNode.textContent!==content){arrayPush(DOMPurify.removed,{element:currentNode.cloneNode()});currentNode.textContent=content}}_executeHooks(hooks.afterSanitizeElements,currentNode,null);return false};var _isValidAttribute=function _isValidAttribute(lcTag,lcName,value){if(SANITIZE_DOM&&(lcName==="id"||lcName==="name")&&(value in document||value in formElement)){return false}if(ALLOW_DATA_ATTR&&!FORBID_ATTR[lcName]&&regExpTest(DATA_ATTR,lcName));else if(ALLOW_ARIA_ATTR&&regExpTest(ARIA_ATTR,lcName));else if(!ALLOWED_ATTR[lcName]||FORBID_ATTR[lcName]){if(_isBasicCustomElement(lcTag)&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,lcTag)||CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag))&&(CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck,lcName)||CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName))||lcName==="is"&&CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp&&regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck,value)||CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function&&CUSTOM_ELEMENT_HANDLING.tagNameCheck(value)));else{return false}}else if(URI_SAFE_ATTRIBUTES[lcName]);else if(regExpTest(IS_ALLOWED_URI$1,stringReplace(value,ATTR_WHITESPACE,"")));else if((lcName==="src"||lcName==="xlink:href"||lcName==="href")&&lcTag!=="script"&&stringIndexOf(value,"data:")===0&&DATA_URI_TAGS[lcTag]);else if(ALLOW_UNKNOWN_PROTOCOLS&&!regExpTest(IS_SCRIPT_OR_DATA,stringReplace(value,ATTR_WHITESPACE,"")));else if(value){return false}else;return true};var _isBasicCustomElement=function _isBasicCustomElement(tagName){return tagName!=="annotation-xml"&&stringMatch(tagName,CUSTOM_ELEMENT)};var _sanitizeAttributes=function _sanitizeAttributes(currentNode){_executeHooks(hooks.beforeSanitizeAttributes,currentNode,null);var attributes=currentNode.attributes;if(!attributes||_isClobbered(currentNode)){return}var hookEvent={attrName:"",attrValue:"",keepAttr:true,allowedAttributes:ALLOWED_ATTR,forceKeepAttr:undefined};var l=attributes.length;var _loop=function _loop(){var attr=attributes[l];var name=attr.name,namespaceURI=attr.namespaceURI,attrValue=attr.value;var lcName=transformCaseFunc(name);var value=name==="value"?attrValue:stringTrim(attrValue);hookEvent.attrName=lcName;hookEvent.attrValue=value;hookEvent.keepAttr=true;hookEvent.forceKeepAttr=undefined;_executeHooks(hooks.uponSanitizeAttribute,currentNode,hookEvent);value=hookEvent.attrValue;if(SANITIZE_NAMED_PROPS&&(lcName==="id"||lcName==="name")){_removeAttribute(name,currentNode);value=SANITIZE_NAMED_PROPS_PREFIX+value}if(SAFE_FOR_XML&&regExpTest(/((--!?|])>)|<\/(style|title)/i,value)){_removeAttribute(name,currentNode);return 0}if(hookEvent.forceKeepAttr){return 0}_removeAttribute(name,currentNode);if(!hookEvent.keepAttr){return 0}if(!ALLOW_SELF_CLOSE_IN_ATTR&&regExpTest(/\/>/i,value)){_removeAttribute(name,currentNode);return 0}if(SAFE_FOR_TEMPLATES){arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],function(expr){value=stringReplace(value,expr," ")})}var lcTag=transformCaseFunc(currentNode.nodeName);if(!_isValidAttribute(lcTag,lcName,value)){return 0}if(trustedTypesPolicy&&_typeof(trustedTypes)==="object"&&typeof trustedTypes.getAttributeType==="function"){if(namespaceURI);else{switch(trustedTypes.getAttributeType(lcTag,lcName)){case"TrustedHTML":{value=trustedTypesPolicy.createHTML(value);break}case"TrustedScriptURL":{value=trustedTypesPolicy.createScriptURL(value);break}}}}try{if(namespaceURI){currentNode.setAttributeNS(namespaceURI,name,value)}else{currentNode.setAttribute(name,value)}if(_isClobbered(currentNode)){_forceRemove(currentNode)}else{arrayPop(DOMPurify.removed)}}catch(_){}},_ret;while(l--){_ret=_loop();if(_ret===0)continue}_executeHooks(hooks.afterSanitizeAttributes,currentNode,null)};var _sanitizeShadowDOM=function _sanitizeShadowDOM(fragment){var shadowNode=null;var shadowIterator=_createNodeIterator(fragment);_executeHooks(hooks.beforeSanitizeShadowDOM,fragment,null);while(shadowNode=shadowIterator.nextNode()){_executeHooks(hooks.uponSanitizeShadowNode,shadowNode,null);_sanitizeElements(shadowNode);_sanitizeAttributes(shadowNode);if(shadowNode.content instanceof DocumentFragment){_sanitizeShadowDOM(shadowNode.content)}}_executeHooks(hooks.afterSanitizeShadowDOM,fragment,null)};DOMPurify.sanitize=function(dirty){var cfg=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var body=null;var importedNode=null;var currentNode=null;var returnNode=null;IS_EMPTY_INPUT=!dirty;if(IS_EMPTY_INPUT){dirty="\x3c!--\x3e"}if(typeof dirty!=="string"&&!_isNode(dirty)){if(typeof dirty.toString==="function"){dirty=dirty.toString();if(typeof dirty!=="string"){throw typeErrorCreate("dirty is not a string, aborting")}}else{throw typeErrorCreate("toString is not a function")}}if(!DOMPurify.isSupported){return dirty}if(!SET_CONFIG){_parseConfig(cfg)}DOMPurify.removed=[];if(typeof dirty==="string"){IN_PLACE=false}if(IN_PLACE){if(dirty.nodeName){var tagName=transformCaseFunc(dirty.nodeName);if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}}else if(dirty instanceof Node){body=_initDocument("\x3c!----\x3e");importedNode=body.ownerDocument.importNode(dirty,true);if(importedNode.nodeType===NODE_TYPE.element&&importedNode.nodeName==="BODY"){body=importedNode}else if(importedNode.nodeName==="HTML"){body=importedNode}else{body.appendChild(importedNode)}}else{if(!RETURN_DOM&&!SAFE_FOR_TEMPLATES&&!WHOLE_DOCUMENT&&dirty.indexOf("<")===-1){return trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(dirty):dirty}body=_initDocument(dirty);if(!body){return RETURN_DOM?null:RETURN_TRUSTED_TYPE?emptyHTML:""}}if(body&&FORCE_BODY){_forceRemove(body.firstChild)}var nodeIterator=_createNodeIterator(IN_PLACE?dirty:body);while(currentNode=nodeIterator.nextNode()){_sanitizeElements(currentNode);_sanitizeAttributes(currentNode);if(currentNode.content instanceof DocumentFragment){_sanitizeShadowDOM(currentNode.content)}}if(IN_PLACE){return dirty}if(RETURN_DOM){if(RETURN_DOM_FRAGMENT){returnNode=createDocumentFragment.call(body.ownerDocument);while(body.firstChild){returnNode.appendChild(body.firstChild)}}else{returnNode=body}if(ALLOWED_ATTR.shadowroot||ALLOWED_ATTR.shadowrootmode){returnNode=importNode.call(originalDocument,returnNode,true)}return returnNode}var serializedHTML=WHOLE_DOCUMENT?body.outerHTML:body.innerHTML;if(WHOLE_DOCUMENT&&ALLOWED_TAGS["!doctype"]&&body.ownerDocument&&body.ownerDocument.doctype&&body.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,body.ownerDocument.doctype.name)){serializedHTML="<!DOCTYPE "+body.ownerDocument.doctype.name+">\n"+serializedHTML}if(SAFE_FOR_TEMPLATES){arrayForEach([MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR],function(expr){serializedHTML=stringReplace(serializedHTML,expr," ")})}return trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(serializedHTML):serializedHTML};DOMPurify.setConfig=function(){var cfg=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_parseConfig(cfg);SET_CONFIG=true};DOMPurify.clearConfig=function(){CONFIG=null;SET_CONFIG=false};DOMPurify.isValidAttribute=function(tag,attr,value){if(!CONFIG){_parseConfig({})}var lcTag=transformCaseFunc(tag);var lcName=transformCaseFunc(attr);return _isValidAttribute(lcTag,lcName,value)};DOMPurify.addHook=function(entryPoint,hookFunction){if(typeof hookFunction!=="function"){return}arrayPush(hooks[entryPoint],hookFunction)};DOMPurify.removeHook=function(entryPoint,hookFunction){if(hookFunction!==undefined){var index=arrayLastIndexOf(hooks[entryPoint],hookFunction);return index===-1?undefined:arraySplice(hooks[entryPoint],index,1)[0]}return arrayPop(hooks[entryPoint])};DOMPurify.removeHooks=function(entryPoint){hooks[entryPoint]=[]};DOMPurify.removeAllHooks=function(){hooks=_createHooksMap()};return DOMPurify}var purify=createDOMPurify();return purify})},{}],2:[function(require,module,exports){"use strict";function e(e){this.message=e}e.prototype=new Error,e.prototype.name="InvalidCharacterError";var r="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(r){var t=String(r).replace(/=+$/,"");if(t.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,a=0,i=0,c="";o=t.charAt(i++);~o&&(n=a%4?64*n+o:o,a++%4)?c+=String.fromCharCode(255&n>>(-2*a&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return c};function t(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,function(e,r){var t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}(t)}catch(e){return r(t)}}function n(e){this.message=e}function o(e,r){if("string"!=typeof e)throw new n("Invalid token specified");var o=!0===(r=r||{}).header?0:1;try{return JSON.parse(t(e.split(".")[o]))}catch(e){throw new n("Invalid token specified: "+e.message)}}n.prototype=new Error,n.prototype.name="InvalidTokenError";var a=o;a["default"]=o,a.InvalidTokenError=n,module.exports=a},{}],3:[function(require,module,exports){module.exports={"cardOnFile.authorization":"Card on File Authorization","cardOnFile.termsAndConditions":"Terms & Conditions","cardOnFile.accept":"ACCEPT","cardOnFile.decline":"DECLINE"}},{}],4:[function(require,module,exports){arguments[4][3][0].apply(exports,arguments)},{dup:3}],5:[function(require,module,exports){module.exports={"cardOnFile.authorization":"Autorisation de la carte au dossier","cardOnFile.termsAndConditions":"Conditions d’utilisation","cardOnFile.accept":"ACCEPTER","cardOnFile.decline":"REFUSER"}},{}],6:[function(require,module,exports){module.exports={"cardOnFile.authorization":"Autorisation de la carte enregistrée","cardOnFile.termsAndConditions":"Conditions générales","cardOnFile.accept":"ACCEPTER","cardOnFile.decline":"REFUSER"}},{}],7:[function(require,module,exports){module.exports={"cardOnFile.authorization":"Autorizzazione carta su file","cardOnFile.termsAndConditions":"Termini e condizioni","cardOnFile.accept":"ACCETTA","cardOnFile.decline":"RIFIUTA"}},{}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NIL",{enumerable:true,get:function get(){return _nil["default"]}});Object.defineProperty(exports,"parse",{enumerable:true,get:function get(){return _parse["default"]}});Object.defineProperty(exports,"stringify",{enumerable:true,get:function get(){return _stringify["default"]}});Object.defineProperty(exports,"v1",{enumerable:true,get:function get(){return _v["default"]}});Object.defineProperty(exports,"v3",{enumerable:true,get:function get(){return _v2["default"]}});Object.defineProperty(exports,"v4",{enumerable:true,get:function get(){return _v3["default"]}});Object.defineProperty(exports,"v5",{enumerable:true,get:function get(){return _v4["default"]}});Object.defineProperty(exports,"validate",{enumerable:true,get:function get(){return _validate["default"]}});Object.defineProperty(exports,"version",{enumerable:true,get:function get(){return _version["default"]}});var _v=_interopRequireDefault(require("./v1.js"));var _v2=_interopRequireDefault(require("./v3.js"));var _v3=_interopRequireDefault(require("./v4.js"));var _v4=_interopRequireDefault(require("./v5.js"));var _nil=_interopRequireDefault(require("./nil.js"));var _version=_interopRequireDefault(require("./version.js"));var _validate=_interopRequireDefault(require("./validate.js"));var _stringify=_interopRequireDefault(require("./stringify.js"));var _parse=_interopRequireDefault(require("./parse.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./nil.js":11,"./parse.js":12,"./stringify.js":16,"./v1.js":17,"./v3.js":18,"./v4.js":20,"./v5.js":21,"./validate.js":22,"./version.js":23}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function md5(bytes){if(typeof bytes==="string"){var msg=unescape(encodeURIComponent(bytes));bytes=new Uint8Array(msg.length);for(var i=0;i<msg.length;++i){bytes[i]=msg.charCodeAt(i)}}return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes),bytes.length*8))}function md5ToHexEncodedArray(input){var output=[];var length32=input.length*32;var hexTab="0123456789abcdef";for(var i=0;i<length32;i+=8){var x=input[i>>5]>>>i%32&255;var hex=parseInt(hexTab.charAt(x>>>4&15)+hexTab.charAt(x&15),16);output.push(hex)}return output}function getOutputLength(inputLength8){return(inputLength8+64>>>9<<4)+14+1}function wordsToMd5(x,len){x[len>>5]|=128<<len%32;x[getOutputLength(len)-1]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=md5ff(a,b,c,d,x[i],7,-680876936);d=md5ff(d,a,b,c,x[i+1],12,-389564586);c=md5ff(c,d,a,b,x[i+2],17,606105819);b=md5ff(b,c,d,a,x[i+3],22,-1044525330);a=md5ff(a,b,c,d,x[i+4],7,-176418897);d=md5ff(d,a,b,c,x[i+5],12,1200080426);c=md5ff(c,d,a,b,x[i+6],17,-1473231341);b=md5ff(b,c,d,a,x[i+7],22,-45705983);a=md5ff(a,b,c,d,x[i+8],7,1770035416);d=md5ff(d,a,b,c,x[i+9],12,-1958414417);c=md5ff(c,d,a,b,x[i+10],17,-42063);b=md5ff(b,c,d,a,x[i+11],22,-1990404162);a=md5ff(a,b,c,d,x[i+12],7,1804603682);d=md5ff(d,a,b,c,x[i+13],12,-40341101);c=md5ff(c,d,a,b,x[i+14],17,-1502002290);b=md5ff(b,c,d,a,x[i+15],22,1236535329);a=md5gg(a,b,c,d,x[i+1],5,-165796510);d=md5gg(d,a,b,c,x[i+6],9,-1069501632);c=md5gg(c,d,a,b,x[i+11],14,643717713);b=md5gg(b,c,d,a,x[i],20,-373897302);a=md5gg(a,b,c,d,x[i+5],5,-701558691);d=md5gg(d,a,b,c,x[i+10],9,38016083);c=md5gg(c,d,a,b,x[i+15],14,-660478335);b=md5gg(b,c,d,a,x[i+4],20,-405537848);a=md5gg(a,b,c,d,x[i+9],5,568446438);d=md5gg(d,a,b,c,x[i+14],9,-1019803690);c=md5gg(c,d,a,b,x[i+3],14,-187363961);b=md5gg(b,c,d,a,x[i+8],20,1163531501);a=md5gg(a,b,c,d,x[i+13],5,-1444681467);d=md5gg(d,a,b,c,x[i+2],9,-51403784);c=md5gg(c,d,a,b,x[i+7],14,1735328473);b=md5gg(b,c,d,a,x[i+12],20,-1926607734);a=md5hh(a,b,c,d,x[i+5],4,-378558);d=md5hh(d,a,b,c,x[i+8],11,-2022574463);c=md5hh(c,d,a,b,x[i+11],16,1839030562);b=md5hh(b,c,d,a,x[i+14],23,-35309556);a=md5hh(a,b,c,d,x[i+1],4,-1530992060);d=md5hh(d,a,b,c,x[i+4],11,1272893353);c=md5hh(c,d,a,b,x[i+7],16,-155497632);b=md5hh(b,c,d,a,x[i+10],23,-1094730640);a=md5hh(a,b,c,d,x[i+13],4,681279174);d=md5hh(d,a,b,c,x[i],11,-358537222);c=md5hh(c,d,a,b,x[i+3],16,-722521979);b=md5hh(b,c,d,a,x[i+6],23,76029189);a=md5hh(a,b,c,d,x[i+9],4,-640364487);d=md5hh(d,a,b,c,x[i+12],11,-421815835);c=md5hh(c,d,a,b,x[i+15],16,530742520);b=md5hh(b,c,d,a,x[i+2],23,-995338651);a=md5ii(a,b,c,d,x[i],6,-198630844);d=md5ii(d,a,b,c,x[i+7],10,1126891415);c=md5ii(c,d,a,b,x[i+14],15,-1416354905);b=md5ii(b,c,d,a,x[i+5],21,-57434055);a=md5ii(a,b,c,d,x[i+12],6,1700485571);d=md5ii(d,a,b,c,x[i+3],10,-1894986606);c=md5ii(c,d,a,b,x[i+10],15,-1051523);b=md5ii(b,c,d,a,x[i+1],21,-2054922799);a=md5ii(a,b,c,d,x[i+8],6,1873313359);d=md5ii(d,a,b,c,x[i+15],10,-30611744);c=md5ii(c,d,a,b,x[i+6],15,-1560198380);b=md5ii(b,c,d,a,x[i+13],21,1309151649);a=md5ii(a,b,c,d,x[i+4],6,-145523070);d=md5ii(d,a,b,c,x[i+11],10,-1120210379);c=md5ii(c,d,a,b,x[i+2],15,718787259);b=md5ii(b,c,d,a,x[i+9],21,-343485551);a=safeAdd(a,olda);b=safeAdd(b,oldb);c=safeAdd(c,oldc);d=safeAdd(d,oldd)}return[a,b,c,d]}function bytesToWords(input){if(input.length===0){return[]}var length8=input.length*8;var output=new Uint32Array(getOutputLength(length8));for(var i=0;i<length8;i+=8){output[i>>5]|=(input[i/8]&255)<<i%32}return output}function safeAdd(x,y){var lsw=(x&65535)+(y&65535);var msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535}function bitRotateLeft(num,cnt){return num<<cnt|num>>>32-cnt}function md5cmn(q,a,b,x,s,t){return safeAdd(bitRotateLeft(safeAdd(safeAdd(a,q),safeAdd(x,t)),s),b)}function md5ff(a,b,c,d,x,s,t){return md5cmn(b&c|~b&d,a,b,x,s,t)}function md5gg(a,b,c,d,x,s,t){return md5cmn(b&d|c&~d,a,b,x,s,t)}function md5hh(a,b,c,d,x,s,t){return md5cmn(b^c^d,a,b,x,s,t)}function md5ii(a,b,c,d,x,s,t){return md5cmn(c^(b|~d),a,b,x,s,t)}var _default=md5;exports["default"]=_default},{}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var randomUUID=typeof crypto!=="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var _default={randomUUID:randomUUID};exports["default"]=_default},{}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _default="00000000-0000-0000-0000-000000000000";exports["default"]=_default},{}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _validate=_interopRequireDefault(require("./validate.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function parse(uuid){if(!(0,_validate["default"])(uuid)){throw TypeError("Invalid UUID")}var v;var arr=new Uint8Array(16);arr[0]=(v=parseInt(uuid.slice(0,8),16))>>>24;arr[1]=v>>>16&255;arr[2]=v>>>8&255;arr[3]=v&255;arr[4]=(v=parseInt(uuid.slice(9,13),16))>>>8;arr[5]=v&255;arr[6]=(v=parseInt(uuid.slice(14,18),16))>>>8;arr[7]=v&255;arr[8]=(v=parseInt(uuid.slice(19,23),16))>>>8;arr[9]=v&255;arr[10]=(v=parseInt(uuid.slice(24,36),16))/1099511627776&255;arr[11]=v/4294967296&255;arr[12]=v>>>24&255;arr[13]=v>>>16&255;arr[14]=v>>>8&255;arr[15]=v&255;return arr}var _default=parse;exports["default"]=_default},{"./validate.js":22}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;exports["default"]=_default},{}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=rng;var getRandomValues;var rnds8=new Uint8Array(16);function rng(){if(!getRandomValues){getRandomValues=typeof crypto!=="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto);if(!getRandomValues){throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")}}return getRandomValues(rnds8)}},{}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function f(s,x,y,z){switch(s){case 0:return x&y^~x&z;case 1:return x^y^z;case 2:return x&y^x&z^y&z;case 3:return x^y^z}}function ROTL(x,n){return x<<n|x>>>32-n}function sha1(bytes){var K=[1518500249,1859775393,2400959708,3395469782];var H=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof bytes==="string"){var msg=unescape(encodeURIComponent(bytes));bytes=[];for(var i=0;i<msg.length;++i){bytes.push(msg.charCodeAt(i))}}else if(!Array.isArray(bytes)){bytes=Array.prototype.slice.call(bytes)}bytes.push(128);var l=bytes.length/4+2;var N=Math.ceil(l/16);var M=new Array(N);for(var _i=0;_i<N;++_i){var arr=new Uint32Array(16);for(var j=0;j<16;++j){arr[j]=bytes[_i*64+j*4]<<24|bytes[_i*64+j*4+1]<<16|bytes[_i*64+j*4+2]<<8|bytes[_i*64+j*4+3]}M[_i]=arr}M[N-1][14]=(bytes.length-1)*8/Math.pow(2,32);M[N-1][14]=Math.floor(M[N-1][14]);M[N-1][15]=(bytes.length-1)*8&4294967295;for(var _i2=0;_i2<N;++_i2){var W=new Uint32Array(80);for(var t=0;t<16;++t){W[t]=M[_i2][t]}for(var _t=16;_t<80;++_t){W[_t]=ROTL(W[_t-3]^W[_t-8]^W[_t-14]^W[_t-16],1)}var a=H[0];var b=H[1];var c=H[2];var d=H[3];var e=H[4];for(var _t2=0;_t2<80;++_t2){var s=Math.floor(_t2/20);var T=ROTL(a,5)+f(s,b,c,d)+e+K[s]+W[_t2]>>>0;e=d;d=c;c=ROTL(b,30)>>>0;b=a;a=T}H[0]=H[0]+a>>>0;H[1]=H[1]+b>>>0;H[2]=H[2]+c>>>0;H[3]=H[3]+d>>>0;H[4]=H[4]+e>>>0}return[H[0]>>24&255,H[0]>>16&255,H[0]>>8&255,H[0]&255,H[1]>>24&255,H[1]>>16&255,H[1]>>8&255,H[1]&255,H[2]>>24&255,H[2]>>16&255,H[2]>>8&255,H[2]&255,H[3]>>24&255,H[3]>>16&255,H[3]>>8&255,H[3]&255,H[4]>>24&255,H[4]>>16&255,H[4]>>8&255,H[4]&255]}var _default=sha1;exports["default"]=_default},{}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;exports.unsafeStringify=unsafeStringify;var _validate=_interopRequireDefault(require("./validate.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var byteToHex=[];for(var i=0;i<256;++i){byteToHex.push((i+256).toString(16).slice(1))}function unsafeStringify(arr){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return byteToHex[arr[offset+0]]+byteToHex[arr[offset+1]]+byteToHex[arr[offset+2]]+byteToHex[arr[offset+3]]+"-"+byteToHex[arr[offset+4]]+byteToHex[arr[offset+5]]+"-"+byteToHex[arr[offset+6]]+byteToHex[arr[offset+7]]+"-"+byteToHex[arr[offset+8]]+byteToHex[arr[offset+9]]+"-"+byteToHex[arr[offset+10]]+byteToHex[arr[offset+11]]+byteToHex[arr[offset+12]]+byteToHex[arr[offset+13]]+byteToHex[arr[offset+14]]+byteToHex[arr[offset+15]]}function stringify(arr){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var uuid=unsafeStringify(arr,offset);if(!(0,_validate["default"])(uuid)){throw TypeError("Stringified UUID is invalid")}return uuid}var _default=stringify;exports["default"]=_default},{"./validate.js":22}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _rng=_interopRequireDefault(require("./rng.js"));var _stringify=require("./stringify.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _nodeId;var _clockseq;var _lastMSecs=0;var _lastNSecs=0;function v1(options,buf,offset){var i=buf&&offset||0;var b=buf||new Array(16);options=options||{};var node=options.node||_nodeId;var clockseq=options.clockseq!==undefined?options.clockseq:_clockseq;if(node==null||clockseq==null){var seedBytes=options.random||(options.rng||_rng["default"])();if(node==null){node=_nodeId=[seedBytes[0]|1,seedBytes[1],seedBytes[2],seedBytes[3],seedBytes[4],seedBytes[5]]}if(clockseq==null){clockseq=_clockseq=(seedBytes[6]<<8|seedBytes[7])&16383}}var msecs=options.msecs!==undefined?options.msecs:Date.now();var nsecs=options.nsecs!==undefined?options.nsecs:_lastNSecs+1;var dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&options.clockseq===undefined){clockseq=clockseq+1&16383}if((dt<0||msecs>_lastMSecs)&&options.nsecs===undefined){nsecs=0}if(nsecs>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}_lastMSecs=msecs;_lastNSecs=nsecs;_clockseq=clockseq;msecs+=122192928e5;var tl=((msecs&268435455)*1e4+nsecs)%4294967296;b[i++]=tl>>>24&255;b[i++]=tl>>>16&255;b[i++]=tl>>>8&255;b[i++]=tl&255;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255;b[i++]=tmh&255;b[i++]=tmh>>>24&15|16;b[i++]=tmh>>>16&255;b[i++]=clockseq>>>8|128;b[i++]=clockseq&255;for(var n=0;n<6;++n){b[i+n]=node[n]}return buf||(0,_stringify.unsafeStringify)(b)}var _default=v1;exports["default"]=_default},{"./rng.js":14,"./stringify.js":16}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _v=_interopRequireDefault(require("./v35.js"));var _md=_interopRequireDefault(require("./md5.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var v3=(0,_v["default"])("v3",48,_md["default"]);var _default=v3;exports["default"]=_default},{"./md5.js":9,"./v35.js":19}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.URL=exports.DNS=void 0;exports["default"]=v35;var _stringify=require("./stringify.js");var _parse=_interopRequireDefault(require("./parse.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function stringToBytes(str){str=unescape(encodeURIComponent(str));var bytes=[];for(var i=0;i<str.length;++i){bytes.push(str.charCodeAt(i))}return bytes}var DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";exports.DNS=DNS;var URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";exports.URL=URL;function v35(name,version,hashfunc){function generateUUID(value,namespace,buf,offset){var _namespace;if(typeof value==="string"){value=stringToBytes(value)}if(typeof namespace==="string"){namespace=(0,_parse["default"])(namespace)}if(((_namespace=namespace)===null||_namespace===void 0?void 0:_namespace.length)!==16){throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)")}var bytes=new Uint8Array(16+value.length);bytes.set(namespace);bytes.set(value,namespace.length);bytes=hashfunc(bytes);bytes[6]=bytes[6]&15|version;bytes[8]=bytes[8]&63|128;if(buf){offset=offset||0;for(var i=0;i<16;++i){buf[offset+i]=bytes[i]}return buf}return(0,_stringify.unsafeStringify)(bytes)}try{generateUUID.name=name}catch(err){}generateUUID.DNS=DNS;generateUUID.URL=URL;return generateUUID}},{"./parse.js":12,"./stringify.js":16}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _native=_interopRequireDefault(require("./native.js"));var _rng=_interopRequireDefault(require("./rng.js"));var _stringify=require("./stringify.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function v4(options,buf,offset){if(_native["default"].randomUUID&&!buf&&!options){return _native["default"].randomUUID()}options=options||{};var rnds=options.random||(options.rng||_rng["default"])();rnds[6]=rnds[6]&15|64;rnds[8]=rnds[8]&63|128;if(buf){offset=offset||0;for(var i=0;i<16;++i){buf[offset+i]=rnds[i]}return buf}return(0,_stringify.unsafeStringify)(rnds)}var _default=v4;exports["default"]=_default},{"./native.js":10,"./rng.js":14,"./stringify.js":16}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _v=_interopRequireDefault(require("./v35.js"));var _sha=_interopRequireDefault(require("./sha1.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var v5=(0,_v["default"])("v5",80,_sha["default"]);var _default=v5;exports["default"]=_default},{"./sha1.js":15,"./v35.js":19}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _regex=_interopRequireDefault(require("./regex.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function validate(uuid){return typeof uuid==="string"&&_regex["default"].test(uuid)}var _default=validate;exports["default"]=_default},{"./regex.js":13}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _validate=_interopRequireDefault(require("./validate.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function version(uuid){if(!(0,_validate["default"])(uuid)){throw TypeError("Invalid UUID")}return parseInt(uuid.slice(14,15),16)}var _default=version;exports["default"]=_default},{"./validate.js":22}],24:[function(require,module,exports){"use strict";var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});var collect_1=require("./collect");var utilities_1=__importDefault(require("./lib/services/utilities"));var common_1=require("./lib/helpers/common");if(typeof window!=="undefined"){window.TokenizeJs=collect_1.TokenizeJs;try{window.PoyntCollectUtilities=utilities_1["default"].getInstance();window.addEventListener("message",function(event){var _a;try{if(event.origin!=="https://cdn.poynt.net"){return}var eventData=(0,common_1.parseMessage)(event);if((eventData===null||eventData===void 0?void 0:eventData.type)==="log"){(_a=window.PoyntCollectUtilities)===null||_a===void 0?void 0:_a.log(eventData.data)}}catch(error){console.error("Error handling message",error)}})}catch(error){console.error("Error initializing Utilities",error)}}},{"./collect":25,"./lib/helpers/common":30,"./lib/services/utilities":41}],25:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.TokenizeJs=void 0;var uuid_1=require("uuid");var constants=__importStar(require("./lib/constants"));var shared_1=__importDefault(require("./lib/services/shared"));var applepay_1=__importDefault(require("./lib/services/applepay"));var googlepay_1=__importDefault(require("./lib/services/googlepay"));var paze_1=__importDefault(require("./lib/services/paze"));var card_on_file_1=__importDefault(require("./lib/services/card-on-file"));var helpers=__importStar(require("./lib/helpers/common"));var type_guards_1=require("./lib/helpers/type-guards");var TokenizeJs=function(){function TokenizeJs(arg1,arg2,arg3){_classCallCheck(this,TokenizeJs);var _a;if((0,type_guards_1.isString)(arg1)&&(0,type_guards_1.isString)(arg2)&&(0,type_guards_1.isObjectOrUndefined)(arg3)){this.sharedService=new shared_1["default"]({businessId:arg1,applicationId:arg2},arg3)}else if((0,type_guards_1.isObject)(arg1)&&(0,type_guards_1.isObjectOrUndefined)(arg2)){this.sharedService=new shared_1["default"](arg1,arg2)}else{console.warn("Invalid constructor arguments");this.sharedService=new shared_1["default"]({businessId:arg1,applicationId:arg2},arg3)}this.applePayService=new applepay_1["default"](this.sharedService);this.googlePayService=new googlepay_1["default"](this.sharedService);this.pazeService=new paze_1["default"](this.sharedService);this.cardOnFileService=new card_on_file_1["default"](this.sharedService);(_a=window.PoyntCollectUtilities)===null||_a===void 0?void 0:_a.log({eventName:"gdp.collect.load",customProperties:_extends({},this.sharedService.options)})}return _createClass(TokenizeJs,[{key:"on",value:function on(eventName,callback){this.sharedService.on(eventName,callback)}},{key:"mount",value:function mount(domElement,document,mountOptions){var _a,_b,_c;var options=helpers.getAllOptions(this.sharedService.options,mountOptions);if(options.enableCardOnFile){this.cardOnFileService.mount(options.locale,options.forceSaveCardOnFile,options.cardAgreementOptions)}var isPaymentFormEnabled=helpers.isPaymentFormEnabled(options);var applePay=(_a=options.paymentMethods)===null||_a===void 0?void 0:_a.includes("apple_pay");var googlePay=(_b=options.paymentMethods)===null||_b===void 0?void 0:_b.includes("google_pay");var paze=(_c=options.paymentMethods)===null||_c===void 0?void 0:_c.includes("paze");if(isPaymentFormEnabled){this.sharedService.mountPaymentForm(domElement,document,options)}if(applePay||googlePay||paze){this.sharedService.mountButtonsContainer(domElement,document,options);if(applePay){this.applePayService.mount(options.locale,options.buttonOptions,options.applePayButtonOptions)}if(googlePay){this.googlePayService.mount(options.locale,options.buttonOptions,options.googlePayButtonOptions)}if(paze){this.pazeService.mount(options.locale,options.buttonOptions,options.pazeButtonOptions)}}if(!isPaymentFormEnabled){this.sharedService.processCallbacks("ready",{type:"ready",data:{}});this.sharedService.processCallbacks("iframe_ready",{type:"iframe_ready",data:{}})}}},{key:"unmount",value:function unmount(domElement,document){this.sharedService.unmount(domElement,document);this.cardOnFileService.unmount()}},{key:"getIFrame",value:function getIFrame(){return this.sharedService.iFrame}},{key:"reload",value:function reload(){var _a,_b;(_b=(_a=this.sharedService.iFrame)===null||_a===void 0?void 0:_a.contentWindow)===null||_b===void 0?void 0:_b.location.reload()}},{key:"getNonce",value:function getNonce(){var getNonceOptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.sharedService.iFrame){return this.sharedService.handleError("CARD_PAYMENT",new Error("iFrame not found"))}getNonceOptions.requestId=(0,uuid_1.v4)();if(this.cardOnFileService.cardAgreementData){getNonceOptions.cardAgreementMetadata=this.cardOnFileService.cardAgreementData.metadata}this.sharedService.postIFrameMessage({type:"op_get_nonce",options:getNonceOptions})}},{key:"startGooglePaySession",value:function startGooglePaySession(walletRequest){this.googlePayService.startSession(walletRequest)}},{key:"startApplePaySession",value:function startApplePaySession(walletRequest){this.applePayService.startSession(walletRequest)}},{key:"startPazeSession",value:function startPazeSession(walletRequest){this.pazeService.startSession(walletRequest)}},{key:"abortApplePaySession",value:function abortApplePaySession(){this.applePayService.abortSession()}},{key:"supportWalletPayments",value:function supportWalletPayments(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee(){var result,domainName,promises,_t;return _regenerator().w(function(_context){while(1)switch(_context.p=_context.n){case 0:result={googlePay:false,applePay:false,paze:false};domainName=helpers.getSourceAppHostname();if(!constants.DOMAIN_BLACKLIST.includes(domainName)){_context.n=1;break}this.sharedService.handleError("WALLET",new Error(domainName+" is blacklisted. Please reach out GDP support."));return _context.a(2,result);case 1:_context.p=1;promises=[this.applePayService.initialize(),this.googlePayService.initialize(),this.pazeService.initialize()];_context.n=2;return Promise.all(promises);case 2:result.applePay=this.applePayService.isReady();result.googlePay=this.googlePayService.isReady();result.paze=this.pazeService.isReady();_context.n=4;break;case 3:_context.p=3;_t=_context.v;this.sharedService.handleError("WALLET",_t);case 4:return _context.a(2,result)}},_callee,this,[[1,3]])}))}}])}();exports.TokenizeJs=TokenizeJs},{"./lib/constants":27,"./lib/helpers/common":30,"./lib/helpers/type-guards":34,"./lib/services/applepay":36,"./lib/services/card-on-file":37,"./lib/services/googlepay":38,"./lib/services/paze":39,"./lib/services/shared":40,uuid:8}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.declineButton=exports.acceptButton=exports.actionButtonsContainer=exports.businessPhoneText=exports.businessWebsiteLink=exports.businessNameText=exports.mainText=exports.closeIcon=exports.closeIconContainer=exports.title=exports.agreementContainer=exports.globalContainer=void 0;exports.globalContainer={position:"fixed",top:"0",left:"0",width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center","background-color":"rgb(186 166 192 / 50%)","z-index":"9999"};exports.agreementContainer={"max-width":"600px",width:"100%","background-color":"#ffffff","font-family":"Roboto, Open Sans, Segoe UI, sans-serif",padding:"20px 40px 40px 40px","border-radius":"10px"};exports.title={"font-size":"1.2rem","font-weight":"bold","margin-bottom":"10px"};exports.closeIconContainer={"text-align":"right"};exports.closeIcon={"font-size":"1.6rem",cursor:"pointer",color:"#8a8a8a"};exports.mainText={"font-size":"1rem"};exports.businessNameText={"font-weight":"bold"};exports.businessWebsiteLink={"text-decoration":"underline",color:"#0946ED"};exports.businessPhoneText={"font-style":"italic"};exports.actionButtonsContainer={display:"flex","justify-content":"center","align-items":"center","flex-wrap":"wrap",gap:"10px","margin-top":"20px"};exports.acceptButton={padding:"10px 50px","background-color":"#0946ED","border-radius":"15px",color:"#ffffff","max-width":"200px",width:"100%"};exports.declineButton={padding:"10px 50px","background-color":"#627792","border-radius":"15px",color:"#ffffff","max-width":"200px",width:"100%"}},{}],27:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}Object.defineProperty(exports,"__esModule",{value:true});exports.GODADDY_CONTACT_LINK=exports.GODADDY_CONTACT_PHONE=exports.COF_DEFAULT_COUNTRY_CODE=exports.COF_DEFAULT_LANGUAGE=exports.ASSETS_CDN_URL=exports.DOMAIN_BLACKLIST=exports.WALLET_SHIPPING_COUNTRY_CODES=exports.DEFAULT_TIMEOUT=exports.PAZE_ALLOWED_CARD_NETWORKS=exports.APPLEPAY_SUPPORTED_NETWORKS=exports.APPLEPAY_MERCHANT_CAPABILITIES=exports.APPLEPAY_VERSION=exports.APPLEPAY_SCRIPT_URL=exports.GOOGLEPAY_ALLOWED_CARD_NETWORKS=exports.GOOGLEPAY_ALLOWED_AUTHN_METHODS=exports.GOOGLEPAY_VERSION_MINOR=exports.GOOGLEPAY_VERSION=exports.GOOGLEPAY_GATEWAY=exports.GOOGLEPAY_MERCHANT_ID=exports.GOOGLEPAY_SCRIPT_URL=exports.GOOGLE_PAY_INTENT_MAP=exports.GOOGLE_PAY_EVENT_MAP=exports.UTILITIES_IFRAME_NAME=exports.WALLET_API_IFRAME_NAME=exports.DEFAULT_LOCALE=exports.IFRAME_NAME=void 0;exports.IFRAME_NAME="poynt-collect-v2-iframe";exports.DEFAULT_LOCALE="en-US";exports.WALLET_API_IFRAME_NAME="poynt-collect-wallet-api";exports.UTILITIES_IFRAME_NAME="poynt-collect-utilities";exports.GOOGLE_PAY_EVENT_MAP=_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"INITIALIZE","shipping_address_change"),"SHIPPING_ADDRESS","shipping_address_change"),"SHIPPING_OPTION","shipping_method_change"),"OFFER","coupon_code_change");exports.GOOGLE_PAY_INTENT_MAP=_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"INITIALIZE","SHIPPING_ADDRESS"),"SHIPPING_ADDRESS","SHIPPING_ADDRESS"),"SHIPPING_OPTION","SHIPPING_OPTION"),"OFFER","OFFER");exports.GOOGLEPAY_SCRIPT_URL="https://pay.google.com/gp/p/js/pay.js";exports.GOOGLEPAY_MERCHANT_ID="BCR2DN4T3D32TPA6";exports.GOOGLEPAY_GATEWAY="godaddypayments";exports.GOOGLEPAY_VERSION=2;exports.GOOGLEPAY_VERSION_MINOR=0;exports.GOOGLEPAY_ALLOWED_AUTHN_METHODS=["PAN_ONLY","CRYPTOGRAM_3DS"];exports.GOOGLEPAY_ALLOWED_CARD_NETWORKS=["AMEX","DISCOVER","JCB","MASTERCARD","VISA"];exports.APPLEPAY_SCRIPT_URL="https://applepay.cdn-apple.com/jsapi/1.latest/apple-pay-sdk.js";exports.APPLEPAY_VERSION=6;exports.APPLEPAY_MERCHANT_CAPABILITIES=["supports3DS"];exports.APPLEPAY_SUPPORTED_NETWORKS=["visa","masterCard","amex","discover","interac"];exports.PAZE_ALLOWED_CARD_NETWORKS=["VISA","MASTERCARD"];exports.DEFAULT_TIMEOUT=15e3;exports.WALLET_SHIPPING_COUNTRY_CODES=[];exports.DOMAIN_BLACKLIST=["websites.godaddy.com"];exports.ASSETS_CDN_URL="https://d85ecz8votkqa.cloudfront.net/images/collect/";exports.COF_DEFAULT_LANGUAGE="EN";exports.COF_DEFAULT_COUNTRY_CODE="US";exports.GODADDY_CONTACT_PHONE="+1 480-463-8300";exports.GODADDY_CONTACT_LINK="https://www.godaddy.com/help/contact-us"},{}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildPaymentRequest=exports.buildWalletNonceError=exports.buildErrors=exports.buildShippingMethods=exports.buildTotal=exports.buildLineItems=void 0;var constants_1=require("../constants");var buildLineItems=function buildLineItems(request){if(!request.lineItems){return[]}return request.lineItems.map(function(_ref){var label=_ref.label,amount=_ref.amount,isPending=_ref.isPending;return{label:label,amount:amount,type:isPending?"pending":"final"}})};exports.buildLineItems=buildLineItems;var buildTotal=function buildTotal(request){if(!request.total){return{label:"",amount:"0.00"}}return{label:request.total.label,amount:request.total.amount,type:request.total.isPending?"pending":"final"}};exports.buildTotal=buildTotal;var buildShippingMethods=function buildShippingMethods(request){var _a;if(!((_a=request.shippingMethods)===null||_a===void 0?void 0:_a.length)){return}return request.shippingMethods.map(function(_ref2){var id=_ref2.id,label=_ref2.label,amount=_ref2.amount,detail=_ref2.detail;return{identifier:id,label:label,amount:amount,detail:detail}})};exports.buildShippingMethods=buildShippingMethods;var buildErrors=function buildErrors(request){var errorCodes={invalid_shipping_address:"shippingContactInvalid",unserviceable_address:"addressUnserviceable",invalid_billing_address:"billingContactInvalid",invalid_coupon_code:"couponCodeInvalid",expired_coupon_code:"couponCodeExpired",invalid_payment_data:"unknown",unknown:"unknown"};var error=request.error;if(!error){return}return[new ApplePayError(error.code?errorCodes[error.code]:"unknown",error.contactField,error.message?error.message:"")]};exports.buildErrors=buildErrors;var buildWalletNonceError=function buildWalletNonceError(error){return[new ApplePayError("unknown",undefined,(error===null||error===void 0?void 0:error.developerMessage)||(error===null||error===void 0?void 0:error.message)||"")]};exports.buildWalletNonceError=buildWalletNonceError;var buildPaymentRequest=function buildPaymentRequest(request){var _a;var requiredShippingContactFields=[];if(request.requireShippingAddress){requiredShippingContactFields.push("name");requiredShippingContactFields.push("postalAddress")}if(request.requireEmail){requiredShippingContactFields.push("email")}if(request.requirePhone){requiredShippingContactFields.push("phone")}return{countryCode:request.country,currencyCode:request.currency,merchantCapabilities:constants_1.APPLEPAY_MERCHANT_CAPABILITIES,supportedNetworks:constants_1.APPLEPAY_SUPPORTED_NETWORKS,total:(0,exports.buildTotal)(request),lineItems:(0,exports.buildLineItems)(request),requiredBillingContactFields:["name","postalAddress"],requiredShippingContactFields:requiredShippingContactFields.length?requiredShippingContactFields:undefined,supportsCouponCode:request.supportCouponCode,couponCode:request.supportCouponCode?(_a=request.couponCode)===null||_a===void 0?void 0:_a.code:undefined}};exports.buildPaymentRequest=buildPaymentRequest},{"../constants":27}],29:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});exports.getCardAgreement=void 0;var dompurify_1=require("dompurify");var constants_1=require("../constants");var localization_1=require("./localization");var defaultStyles=__importStar(require("../assets/card-on-file/styles"));var templateFilenameByType=_defineProperty(_defineProperty(_defineProperty({},"DEFAULT","DEFAULT.html"),"CARD_ON_FILE","CARD_ON_FILE.hbs"),"INSTANT_PAYOUT","INSTANT_PAYOUT.hbs");var getTemplateType=function getTemplateType(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(options.templateType&&templateFilenameByType[options.templateType]){return options.templateType}if(options.businessName&&options.businessWebsite&&options.businessPhone){return"CARD_ON_FILE"}return"DEFAULT"};var getCardAgreementFilePath=function getCardAgreementFilePath(metadata){var filename=templateFilenameByType[metadata.templateType];if(!filename){throw new Error("Unknown template type: ".concat(metadata.templateType))}return"https://d1oxd31ykxugjs.cloudfront.net".concat("/",metadata.lang,"/").concat(metadata.countryCode,"/").concat(filename)};var createElement=function createElement(elementName,defaultStyles,customStyles,hide){var element=document.createElement(elementName);if(defaultStyles){Object.keys(defaultStyles).forEach(function(property){element.style.setProperty(property,defaultStyles[property])})}if(customStyles){Object.keys(customStyles).forEach(function(property){element.style.setProperty(property,customStyles[property])})}if(hide){element.style.display="none"}return element};var compileCardAgreementTemplate=function compileCardAgreementTemplate(template,metadata){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var customStyles=options.style||{};var agreement=template.replace(new RegExp("\n","g")," ").replace(new RegExp("<.*?>","g"),"");if(metadata.templateType==="INSTANT_PAYOUT"){var businessWebsiteElement=createElement("a",defaultStyles.businessWebsiteLink,customStyles.businessWebsiteLink);var businessPhoneElement=createElement("span",defaultStyles.businessPhoneText,customStyles.businessPhoneText);businessWebsiteElement.textContent=constants_1.GODADDY_CONTACT_LINK;businessPhoneElement.textContent=constants_1.GODADDY_CONTACT_PHONE;businessWebsiteElement.setAttribute("href",constants_1.GODADDY_CONTACT_LINK);businessWebsiteElement.setAttribute("target","_blank");businessWebsiteElement.setAttribute("rel","noopener noreferrer");return agreement.replace(new RegExp("{{business_website}}","g"),businessWebsiteElement.outerHTML).replace(new RegExp("{{business_contact_phone}}","g"),businessPhoneElement.outerHTML)}if(metadata.templateType==="CARD_ON_FILE"){var businessNameElement=createElement("span",defaultStyles.businessNameText,customStyles.businessNameText);var _businessWebsiteElement=createElement("a",defaultStyles.businessWebsiteLink,customStyles.businessWebsiteLink,options.hideBusinessWebsite);var _businessPhoneElement=createElement("span",defaultStyles.businessPhoneText,customStyles.businessPhoneText,options.hideBusinessPhone);businessNameElement.textContent=metadata.businessName||"";_businessWebsiteElement.textContent=" "+(metadata.businessWebsite||"");_businessPhoneElement.textContent=" "+(metadata.businessPhone||"");_businessWebsiteElement.setAttribute("href",metadata.businessWebsite||"");_businessWebsiteElement.setAttribute("target","_blank");_businessWebsiteElement.setAttribute("rel","noopener noreferrer");return agreement.replace(new RegExp("{{business_name}}","g"),businessNameElement.outerHTML).replace(new RegExp("\\s?{{business_website}}","g"),_businessWebsiteElement.outerHTML).replace(new RegExp("\\s?{{business_contact_phone}}","g"),_businessPhoneElement.outerHTML)}return agreement};var genereteCardAgreementHtml=function genereteCardAgreementHtml(agreement,metadata,locale){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var hideActionButtons=arguments.length>4?arguments[4]:undefined;var onAcceptClick=arguments.length>5?arguments[5]:undefined;var onDeclineClick=arguments.length>6?arguments[6]:undefined;var customStyles=options.style||{};var globalContainer=createElement("div",defaultStyles.globalContainer,customStyles.globalContainer);var agreementContainer=createElement("div",defaultStyles.agreementContainer,customStyles.agreementContainer);var title=createElement("h1",defaultStyles.title,customStyles.title);var closeIconContainer=createElement("div",defaultStyles.closeIconContainer,customStyles.closeIconContainer);var closeIcon=createElement("span",defaultStyles.closeIcon,customStyles.closeIcon);var mainText=createElement("p",defaultStyles.mainText,customStyles.mainText);var actionButtonsContainer=createElement("div",defaultStyles.actionButtonsContainer,customStyles.actionButtonsContainer);var acceptButton=createElement("button",defaultStyles.acceptButton,customStyles.acceptButton);var declineButton=createElement("button",defaultStyles.declineButton,customStyles.declineButton);globalContainer.setAttribute("data-testid","card_agreement_modal");acceptButton.setAttribute("data-testid","card_agreement_accept_button");declineButton.setAttribute("data-testid","card_agreement_decline_button");var messages=(0,localization_1.getMessages)(locale);mainText.innerHTML=(0,dompurify_1.sanitize)(agreement,{ALLOWED_TAGS:["span","a"],ALLOWED_ATTR:["style","href","target","rel"]});closeIcon.innerHTML="&#215;";if(metadata.templateType==="INSTANT_PAYOUT"){title.textContent=messages["cardOnFile.authorization"]}else{title.textContent=messages["cardOnFile.termsAndConditions"]}acceptButton.textContent=messages["cardOnFile.accept"];declineButton.textContent=messages["cardOnFile.decline"];closeIconContainer.appendChild(closeIcon);actionButtonsContainer.appendChild(declineButton);actionButtonsContainer.appendChild(acceptButton);agreementContainer.appendChild(closeIconContainer);agreementContainer.appendChild(title);agreementContainer.appendChild(mainText);if(!hideActionButtons){agreementContainer.appendChild(actionButtonsContainer)}globalContainer.appendChild(agreementContainer);globalContainer.onclick=function(event){var isClickInside=agreementContainer.contains(event.target);if(!isClickInside&&document.body.contains(globalContainer)){document.body.removeChild(globalContainer)}};closeIcon.onclick=function(){if(document.body.contains(globalContainer)){document.body.removeChild(globalContainer)}};if(onAcceptClick){acceptButton.onclick=onAcceptClick}if(onDeclineClick){declineButton.onclick=onDeclineClick}return globalContainer};var requestTemplate=function requestTemplate(metadata){return __awaiter(void 0,void 0,void 0,_regenerator().m(function _callee(){var response,lang,countryCode,template,_t;return _regenerator().w(function(_context){while(1)switch(_context.p=_context.n){case 0:_context.p=0;_context.n=1;return fetch(getCardAgreementFilePath(metadata));case 1:response=_context.v;if(response.ok){_context.n=2;break}lang=metadata.lang,countryCode=metadata.countryCode;console.warn('Unable to fetch template for language "'.concat(lang,'" and countryCode "').concat(countryCode,'"'));_context.n=4;break;case 2:_context.n=3;return response.text();case 3:template=_context.v;return _context.a(2,{template:template,metadata:metadata});case 4:_context.n=6;break;case 5:_context.p=5;_t=_context.v;console.error(_t);case 6:return _context.a(2,null)}},_callee,null,[[0,5]])}))};var findTemplate=function findTemplate(metadata){return __awaiter(void 0,void 0,void 0,_regenerator().m(function _callee2(){var localizedTemplate,defaultMetadata,defaultTemplate;return _regenerator().w(function(_context2){while(1)switch(_context2.n){case 0:_context2.n=1;return requestTemplate(metadata);case 1:localizedTemplate=_context2.v;if(!localizedTemplate){_context2.n=2;break}return _context2.a(2,localizedTemplate);case 2:defaultMetadata=_extends(_extends({},metadata),{lang:constants_1.COF_DEFAULT_LANGUAGE,countryCode:constants_1.COF_DEFAULT_COUNTRY_CODE});_context2.n=3;return requestTemplate(defaultMetadata);case 3:defaultTemplate=_context2.v;if(!defaultTemplate){_context2.n=4;break}return _context2.a(2,defaultTemplate);case 4:return _context2.a(2,null)}},_callee2)}))};var getCardAgreement=function getCardAgreement(locale,hideActionButtons,options,onAcceptClick,onDeclineClick){return __awaiter(void 0,void 0,void 0,_regenerator().m(function _callee3(){var intialMetadata,templateResponse,template,metadata,agreement,container;return _regenerator().w(function(_context3){while(1)switch(_context3.n){case 0:intialMetadata={lang:(locale===null||locale===void 0?void 0:locale.length)===5?locale.slice(0,2).toUpperCase():constants_1.COF_DEFAULT_LANGUAGE,countryCode:(locale===null||locale===void 0?void 0:locale.length)===5?locale.slice(-2).toUpperCase():constants_1.COF_DEFAULT_COUNTRY_CODE,templateType:getTemplateType(options),businessName:options===null||options===void 0?void 0:options.businessName,businessWebsite:options===null||options===void 0?void 0:options.businessWebsite,businessPhone:options===null||options===void 0?void 0:options.businessPhone};_context3.n=1;return findTemplate(intialMetadata);case 1:templateResponse=_context3.v;if(templateResponse){_context3.n=2;break}throw new Error("Card agreement template not found");case 2:template=templateResponse.template,metadata=templateResponse.metadata;agreement=compileCardAgreementTemplate(template,metadata,options);container=genereteCardAgreementHtml(agreement,metadata,locale||constants_1.DEFAULT_LOCALE,options,hideActionButtons,onAcceptClick,onDeclineClick);return _context3.a(2,{container:container,metadata:metadata})}},_callee3)}))};exports.getCardAgreement=getCardAgreement},{"../assets/card-on-file/styles":26,"../constants":27,"./localization":32,dompurify:1}],30:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();Object.defineProperty(exports,"__esModule",{value:true});exports.getSourceAppHostname=exports.createDefaultWalletRequest=exports.setButtonsContainerProperties=exports.setButtonProperties=exports.createIFrame=exports.getAllOptions=exports.getParentPort=exports.getParentOrigin=exports.shouldEnableCardOnFile=exports.isPaymentFormEnabled=exports.parseMessage=exports.loadScript=exports.removeCachedScripts=exports.getCachedScripts=void 0;var localization_1=require("./localization");var constants=__importStar(require("../constants"));var cachedScripts={};var getCachedScripts=function getCachedScripts(){return _extends({},cachedScripts)};exports.getCachedScripts=getCachedScripts;var removeCachedScripts=function removeCachedScripts(){Object.keys(cachedScripts).forEach(function(key){return cachedScripts[key]=null})};exports.removeCachedScripts=removeCachedScripts;var loadScript=function loadScript(src){var existing=cachedScripts[src];if(existing){return existing}var promise=new Promise(function(resolve,reject){var script=document.createElement("script");script.src=src;script.async=true;var onScriptLoad=function onScriptLoad(){resolve()};var _onScriptError=function onScriptError(){script.removeEventListener("load",onScriptLoad);script.removeEventListener("error",_onScriptError);cachedScripts[src]=null;script.remove();reject(new Error("Unable to load script ".concat(src)))};script.addEventListener("load",onScriptLoad);script.addEventListener("error",_onScriptError);document.body.appendChild(script)});cachedScripts[src]=promise;return promise};exports.loadScript=loadScript;var parseMessage=function parseMessage(event){try{return JSON.parse(event.data)}catch(error){console.error(error)}return null};exports.parseMessage=parseMessage;var isPaymentFormEnabled=function isPaymentFormEnabled(options){var _a;return!((_a=options.paymentMethods)===null||_a===void 0?void 0:_a.length)||options.paymentMethods.includes("card")||options.paymentMethods.includes("ach")};exports.isPaymentFormEnabled=isPaymentFormEnabled;var shouldEnableCardOnFile=function shouldEnableCardOnFile(options){if(!(0,exports.isPaymentFormEnabled)(options)){return false}return!!options.enableCardOnFile};exports.shouldEnableCardOnFile=shouldEnableCardOnFile;var getParentOrigin=function getParentOrigin(){if(document.location.hostname!=="localhost"){return document.location.origin}};exports.getParentOrigin=getParentOrigin;var getParentPort=function getParentPort(){if(document.location.hostname==="localhost"){return document.location.port}};exports.getParentPort=getParentPort;var getAllOptions=function getAllOptions(options,mountOptions){return _extends(_extends({},mountOptions),{businessId:options.businessId,applicationId:options.applicationId,sessionId:options.sessionId,storeId:options.storeId,channelId:options.channelId,parentOrigin:(0,exports.getParentOrigin)(),parentPort:(0,exports.getParentPort)(),locale:(0,localization_1.getLocale)(mountOptions===null||mountOptions===void 0?void 0:mountOptions.locale),enableReCaptcha:!!(mountOptions===null||mountOptions===void 0?void 0:mountOptions.enableReCaptcha),enableCardOnFile:(0,exports.shouldEnableCardOnFile)(mountOptions||{})})};exports.getAllOptions=getAllOptions;var createIFrame=function createIFrame(options){var iFrame=document.createElement("iframe");var queryParams=new URLSearchParams;if(options.parentOrigin){queryParams.set("parentOrigin",options.parentOrigin)}if(options.parentPort){queryParams.set("parentPort",options.parentPort)}if(options.sessionId){queryParams.set("sessionId",options.sessionId)}iFrame.setAttribute("name",constants.IFRAME_NAME);iFrame.setAttribute("id",constants.IFRAME_NAME);iFrame.setAttribute("src","https://cdn.poynt.net/collect/payment-form/index.html".concat("?",queryParams.toString()));if(options.iFrame){iFrame.style.cssText=JSON.stringify(options.iFrame);if(options.iFrame.height){iFrame.style["height"]=options.iFrame.height}if(options.iFrame.width){iFrame.style["width"]=options.iFrame.width}if(options.iFrame.border){iFrame.style["border"]=options.iFrame.border}if(options.iFrame.borderRadius){iFrame.style["borderRadius"]=options.iFrame.borderRadius}if(options.iFrame.boxShadow){iFrame.style["boxShadow"]=options.iFrame.boxShadow}}return iFrame};exports.createIFrame=createIFrame;var setButtonProperties=function setButtonProperties(container,buttonOptions){var regularButton=container.getElementsByTagName("button")[0];var applePayButton=container.getElementsByTagName("apple-pay-button")[0];var button=regularButton||applePayButton;var minWidth=(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.type)==="plain"?"160px":"240px";var minHeight="40px";var margin="8px";if(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.disabled){button.setAttribute("disabled","true");button.style.setProperty("pointer-events","none")}if(applePayButton){button.style.setProperty("--apple-pay-button-width","100%");button.style.setProperty("--apple-pay-button-height","100%");button.style.setProperty("--apple-pay-button-min-height","40px");button.style.setProperty("--apple-pay-button-min-width","160px");button.style.setProperty("--apple-pay-button-border","unset");button.style.setProperty("--apple-pay-button-outline-offset","0");button.style.setProperty("--apple-pay-button-outline",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.border)||"revert");button.style.setProperty("--apple-pay-button-border-radius",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.borderRadius)||"5px")}button.style.setProperty("width","100%");button.style.setProperty("height","100%");button.style.setProperty("min-height",minHeight);button.style.setProperty("min-width",minWidth);button.style.setProperty("border","unset");button.style.setProperty("outline-offset","0");button.style.setProperty("outline",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.border)||"revert");button.style.setProperty("border-radius",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.borderRadius)||"5px");container.style.setProperty("min-width",minWidth);container.style.setProperty("min-height",minHeight);container.style.setProperty("margin",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.margin)||margin);container.style.setProperty("width",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.width)||minWidth);container.style.setProperty("height",(buttonOptions===null||buttonOptions===void 0?void 0:buttonOptions.height)||minHeight);return container};exports.setButtonProperties=setButtonProperties;var setButtonsContainerProperties=function setButtonsContainerProperties(container,buttonsContainerOptions){container.style.setProperty("display","flex");container.style.setProperty("justify-content",(buttonsContainerOptions===null||buttonsContainerOptions===void 0?void 0:buttonsContainerOptions.justifyContent)||"center");container.style.setProperty("align-items",(buttonsContainerOptions===null||buttonsContainerOptions===void 0?void 0:buttonsContainerOptions.alignItems)||"center");container.style.setProperty("flex-direction",(buttonsContainerOptions===null||buttonsContainerOptions===void 0?void 0:buttonsContainerOptions.flexDirection)||"row");if(buttonsContainerOptions===null||buttonsContainerOptions===void 0?void 0:buttonsContainerOptions.style){var cssRules=Object.entries(buttonsContainerOptions.style);cssRules.forEach(function(cssRule){container.style.setProperty(cssRule[0],cssRule[1])})}return container};exports.setButtonsContainerProperties=setButtonsContainerProperties;var createDefaultWalletRequest=function createDefaultWalletRequest(){return{currency:"USD",country:"US",merchantName:"",total:{label:"",amount:"0.00"}}};exports.createDefaultWalletRequest=createDefaultWalletRequest;var getSourceAppHostname=function getSourceAppHostname(){var url=new URL(document.location.href);var sourceAppHostname=url.searchParams.get("sourceAppHostname");if(sourceAppHostname){var sanitizedSourceAppHostname=sourceAppHostname.replace(/[^a-zA-Z0-9.-]/g,"");var hostnameRegex=/^(?:([a-z0-9-]+\.)+)?([a-z0-9-]{1,61})\.([a-z0-9]{2,7})$/i;if(!hostnameRegex.test(sanitizedSourceAppHostname)){console.warn("Invalid sourceAppHostname provided. Ignoring.");return document.location.hostname}return sanitizedSourceAppHostname}return document.location.hostname};exports.getSourceAppHostname=getSourceAppHostname},{"../constants":27,"./localization":32}],31:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}Object.defineProperty(exports,"__esModule",{value:true});exports.buildPaymentRequest=exports.buildPaymentDataChangedHandlerError=exports.buildWalletNonceError=exports.buildMissedHandlerError=exports.buildDuplicateCouponCodeError=exports.buildError=exports.buildOfferInfo=exports.buildShippingMethods=exports.buildTransactionInfo=exports.buildLineItems=exports.getCardPaymentMethod=exports.getBaseCardPaymentMethod=void 0;var constants_1=require("../constants");var getBaseCardPaymentMethod=function getBaseCardPaymentMethod(request){var result={type:"CARD",parameters:{allowedAuthMethods:constants_1.GOOGLEPAY_ALLOWED_AUTHN_METHODS,allowedCardNetworks:constants_1.GOOGLEPAY_ALLOWED_CARD_NETWORKS}};result.parameters.billingAddressRequired=true;result.parameters.billingAddressParameters={format:"FULL"};if(request.requirePhone){result.parameters.billingAddressParameters.phoneNumberRequired=true}return result};exports.getBaseCardPaymentMethod=getBaseCardPaymentMethod;var getCardPaymentMethod=function getCardPaymentMethod(request,businessId){var baseCardPaymentMethod=(0,exports.getBaseCardPaymentMethod)(request);return _extends({tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:constants_1.GOOGLEPAY_GATEWAY,gatewayMerchantId:businessId}}},baseCardPaymentMethod)};exports.getCardPaymentMethod=getCardPaymentMethod;var buildLineItems=function buildLineItems(request){if(!request.lineItems){return[]}return request.lineItems.map(function(lineItem){return{label:lineItem.label,price:lineItem.amount,type:"LINE_ITEM",status:lineItem.isPending?"PENDING":"FINAL"}})};exports.buildLineItems=buildLineItems;var buildTransactionInfo=function buildTransactionInfo(request){var items=(0,exports.buildLineItems)(request);if(!request.total){return{countryCode:request.country,currencyCode:request.currency||"",totalPrice:"0.00",totalPriceStatus:"ESTIMATED",displayItems:items}}return{countryCode:request.country,currencyCode:request.currency,totalPrice:request.total.amount,totalPriceLabel:request.total.label,totalPriceStatus:request.total.isPending?"ESTIMATED":"FINAL",displayItems:items}};exports.buildTransactionInfo=buildTransactionInfo;var buildShippingMethods=function buildShippingMethods(request){var _a;if(!((_a=request.shippingMethods)===null||_a===void 0?void 0:_a.length)){return}var options=request.shippingMethods.map(function(shippingMethod){return{id:shippingMethod.id,label:shippingMethod.label,description:shippingMethod.detail}});return{shippingOptions:options}};exports.buildShippingMethods=buildShippingMethods;var buildOfferInfo=function buildOfferInfo(request){var _a;if(!((_a=request.couponCode)===null||_a===void 0?void 0:_a.code)){return{offers:[]}}return{offers:[{redemptionCode:request.couponCode.code,description:request.couponCode.label}]}};exports.buildOfferInfo=buildOfferInfo;var buildError=function buildError(request,callbackIntent){var errorCodes={invalid_shipping_address:"SHIPPING_ADDRESS_INVALID",unserviceable_address:"SHIPPING_ADDRESS_UNSERVICEABLE",invalid_billing_address:"PAYMENT_DATA_INVALID",invalid_coupon_code:"OFFER_INVALID",expired_coupon_code:"OFFER_INVALID",invalid_payment_data:"PAYMENT_DATA_INVALID",unknown:"OTHER_ERROR"};var error=request.error;if(!error){return}return{reason:error.code?errorCodes[error.code]:errorCodes.unknown,intent:callbackIntent,message:error.message||""}};exports.buildError=buildError;var buildDuplicateCouponCodeError=function buildDuplicateCouponCodeError(callbackIntent){return{reason:"OFFER_INVALID",intent:callbackIntent,message:"Coupon code already applied"}};exports.buildDuplicateCouponCodeError=buildDuplicateCouponCodeError;var buildMissedHandlerError=function buildMissedHandlerError(eventType,callbackIntent){return{reason:"OTHER_ERROR",intent:callbackIntent,message:"".concat(eventType," callback handler not found")}};exports.buildMissedHandlerError=buildMissedHandlerError;var buildWalletNonceError=function buildWalletNonceError(callbackIntent,error){return{reason:"OTHER_ERROR",intent:callbackIntent,message:(error===null||error===void 0?void 0:error.developerMessage)||(error===null||error===void 0?void 0:error.message)||""}};exports.buildWalletNonceError=buildWalletNonceError;var buildPaymentDataChangedHandlerError=function buildPaymentDataChangedHandlerError(callbackTrigger){return{reason:"OTHER_ERROR",intent:constants_1.GOOGLE_PAY_INTENT_MAP[callbackTrigger],message:'Callback trigger "'.concat(callbackTrigger,'" not found or intermediate payment data does not exist')}};exports.buildPaymentDataChangedHandlerError=buildPaymentDataChangedHandlerError;var buildPaymentRequest=function buildPaymentRequest(request,businessId,authJwt){var _a,_b;var merchantInfo={merchantId:constants_1.GOOGLEPAY_MERCHANT_ID,merchantOrigin:document.location.hostname,merchantName:request.merchantName,authJwt:authJwt};var result={apiVersion:constants_1.GOOGLEPAY_VERSION,apiVersionMinor:constants_1.GOOGLEPAY_VERSION_MINOR,merchantInfo:merchantInfo,allowedPaymentMethods:[(0,exports.getCardPaymentMethod)(request,businessId)],transactionInfo:(0,exports.buildTransactionInfo)(request)};var callbackIntents=["PAYMENT_AUTHORIZATION"];if(request.requireShippingAddress){callbackIntents.push("SHIPPING_ADDRESS");result.shippingAddressRequired=true;if(typeof request.requireShippingMethods==="undefined"||request.requireShippingMethods){result.shippingOptionRequired=true;callbackIntents.push("SHIPPING_OPTION")}result.shippingAddressParameters={allowedCountryCodes:constants_1.WALLET_SHIPPING_COUNTRY_CODES,phoneNumberRequired:request.requirePhone};if((_a=request.shippingMethods)===null||_a===void 0?void 0:_a.length){result.shippingOptionParameters=(0,exports.buildShippingMethods)(request)}}if(request.supportCouponCode){callbackIntents.push("OFFER");if((_b=request.couponCode)===null||_b===void 0?void 0:_b.code){result.offerInfo={offers:[{redemptionCode:request.couponCode.code,description:request.couponCode.label}]}}}if(request.requireEmail){result.emailRequired=true}result.callbackIntents=callbackIntents;return result};exports.buildPaymentRequest=buildPaymentRequest},{"../constants":27}],32:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.getLanguageCode=exports.getMessages=exports.getLocale=void 0;var constants_1=require("../constants");var snippet_json_1=__importDefault(require("l10n/collect/en-us/snippet.json"));var snippet_json_2=__importDefault(require("l10n/collect/en-ca/snippet.json"));var snippet_json_3=__importDefault(require("l10n/collect/fr-ca/snippet.json"));var snippet_json_4=__importDefault(require("l10n/collect/fr-fr/snippet.json"));var snippet_json_5=__importDefault(require("l10n/collect/it-IT/snippet.json"));var supportedLocalesMap=new Map([["en","en-US"],["en-us","en-US"],["en-US","en-US"],["en-ca","en-CA"],["en-CA","en-CA"],["fr","fr-FR"],["fr-ca","fr-CA"],["fr-CA","fr-CA"],["fr-fr","fr-FR"],["fr-FR","fr-FR"],["it","it-IT"],["it-it","it-IT"],["it-IT","it-IT"]]);var messages={"en-US":snippet_json_1["default"],"en-CA":snippet_json_2["default"],"fr-CA":snippet_json_3["default"],"fr-FR":snippet_json_4["default"],"it-IT":snippet_json_5["default"]};var getLocale=function getLocale(locale){if(locale&&supportedLocalesMap.has(locale)){return supportedLocalesMap.get(locale)}var cookieMarket=document.cookie.split(";").find(function(cookie){return cookie.includes("market=")})||"";var cookieLocale=cookieMarket.split("=")[1]||"";if(cookieLocale&&supportedLocalesMap.has(cookieLocale)){return supportedLocalesMap.get(cookieLocale)}if(window.navigator.language&&supportedLocalesMap.has(window.navigator.language)){return supportedLocalesMap.get(window.navigator.language)}return constants_1.DEFAULT_LOCALE};exports.getLocale=getLocale;var getMessages=function getMessages(locale){return messages[locale]?_extends(_extends({},messages[constants_1.DEFAULT_LOCALE]),messages[locale]):messages[constants_1.DEFAULT_LOCALE]};exports.getMessages=getMessages;var getLanguageCode=function getLanguageCode(locale){return(locale===null||locale===void 0?void 0:locale.split("-")[0])||"en"};exports.getLanguageCode=getLanguageCode},{"../constants":27,"l10n/collect/en-ca/snippet.json":3,"l10n/collect/en-us/snippet.json":4,"l10n/collect/fr-ca/snippet.json":5,"l10n/collect/fr-fr/snippet.json":6,"l10n/collect/it-IT/snippet.json":7}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildPaymentAuthorizedResponse=exports.buildAddress=exports.buildFullName=exports.buildPhoneNumber=exports.buildWalletNonceRequest=exports.buildCompleteRequest=exports.buildCheckoutRequest=exports.formatAmountWithCents=exports.getOrderQuantity=exports.getPazeScriptUrl=void 0;var constants_1=require("../constants");var getPazeScriptUrl=function getPazeScriptUrl(){return"https://checkout.paze.com/web/resources/js/digitalwallet-sdk.js".concat("?id=","46VM0VIBJ63520UZ7X6U14L-0rahMJIVUiE1MgKLDdBgyTXkE")};exports.getPazeScriptUrl=getPazeScriptUrl;var getOrderQuantity=function getOrderQuantity(lineItems){if(!(lineItems===null||lineItems===void 0?void 0:lineItems.length)){return}return lineItems.length.toString()};exports.getOrderQuantity=getOrderQuantity;var formatAmountWithCents=function formatAmountWithCents(amount){if(!amount||!Number(amount)){return"0.00"}var parts=amount.split(".");if(parts.length===1){return"".concat(parts[0],".00")}if(parts.length===2&&parts[1].length===1){return"".concat(parts[0],".").concat(parts[1],"0")}return amount};exports.formatAmountWithCents=formatAmountWithCents;var buildCheckoutRequest=function buildCheckoutRequest(request,sessionId){return{intent:"EXPRESS_CHECKOUT",sessionId:sessionId,actionCode:"START_FLOW",transactionValue:{transactionCurrencyCode:request.currency,transactionAmount:(0,exports.formatAmountWithCents)(request.total.amount)},enhancedTransactionData:{orderQuantity:(0,exports.getOrderQuantity)(request.lineItems)},shippingPreference:request.requireShippingAddress?"ALL":"NONE",billingPreference:"ALL",acceptedShippingCountries:constants_1.WALLET_SHIPPING_COUNTRY_CODES,acceptedPaymentCardNetworks:constants_1.PAZE_ALLOWED_CARD_NETWORKS}};exports.buildCheckoutRequest=buildCheckoutRequest;var buildCompleteRequest=function buildCompleteRequest(request,sessionId){return{sessionId:sessionId,transactionType:"PURCHASE",transactionValue:{transactionCurrencyCode:request.currency,transactionAmount:(0,exports.formatAmountWithCents)(request.total.amount)},transactionOptions:{billingPreference:"ALL",payloadTypeIndicator:"PAYMENT"},enhancedTransactionData:{orderQuantity:(0,exports.getOrderQuantity)(request.lineItems)}}};exports.buildCompleteRequest=buildCompleteRequest;var buildWalletNonceRequest=function buildWalletNonceRequest(checkout,complete,requestId){var result={pazePaymentToken:{paymentTokenJwt:complete.completeResponse}};var billingAddress=checkout.maskedCard.billingAddress;var customerInfo=checkout.consumer;if(billingAddress){result.zip=billingAddress.zip;result.line1=billingAddress.line1;result.line2=billingAddress.line2;result.city=billingAddress.city;result.territory=billingAddress.state;result.countryCode=billingAddress.countryCode}if(customerInfo){result.firstName=customerInfo.firstName;result.lastName=customerInfo.lastName}if(requestId){result.requestId=requestId}return result};exports.buildWalletNonceRequest=buildWalletNonceRequest;var buildPhoneNumber=function buildPhoneNumber(customerInfo,deliveryContactDetails){var deliveryPhone=deliveryContactDetails===null||deliveryContactDetails===void 0?void 0:deliveryContactDetails.contactPhoneNumber;if(deliveryPhone){return"".concat(deliveryPhone.countryCode).concat(deliveryPhone.phoneNumber).trim()}var customerPhone=customerInfo===null||customerInfo===void 0?void 0:customerInfo.mobileNumber;if(customerPhone){return"".concat(customerPhone.countryCode).concat(customerPhone.phoneNumber).trim()}return""};exports.buildPhoneNumber=buildPhoneNumber;var buildFullName=function buildFullName(customerInfo,deliveryContactDetails){if(deliveryContactDetails===null||deliveryContactDetails===void 0?void 0:deliveryContactDetails.contactFullName){return deliveryContactDetails.contactFullName}if(!customerInfo){return""}if(customerInfo.fullName){return customerInfo.fullName}return[customerInfo.firstName,customerInfo.lastName].filter(Boolean).join(" ")};exports.buildFullName=buildFullName;var buildAddress=function buildAddress(address,customerInfo){var result={administrativeArea:address.state,countryCode:address.countryCode,postalCode:address.zip,locality:address.city,addressLines:[address.line1,address.line2,address.line3].filter(Boolean)};if(customerInfo){result.emailAddress=customerInfo.emailAddress;if("deliveryContactDetails"in address){result.name=(0,exports.buildFullName)(customerInfo,address.deliveryContactDetails);result.phoneNumber=(0,exports.buildPhoneNumber)(customerInfo,address.deliveryContactDetails)}else{result.name=(0,exports.buildFullName)(customerInfo);result.phoneNumber=(0,exports.buildPhoneNumber)(customerInfo)}}return result};exports.buildAddress=buildAddress;var buildPaymentAuthorizedResponse=function buildPaymentAuthorizedResponse(checkout,nonceResponse,requireShippingAddress){var result={nonce:nonceResponse.nonce,source:"paze"};var billingAddress=checkout.maskedCard.billingAddress;var shippingAddress=checkout.shippingAddress;var customerInfo=checkout.consumer;if(billingAddress){result.billingAddress=(0,exports.buildAddress)(billingAddress,customerInfo)}if(requireShippingAddress&&shippingAddress){result.shippingAddress=(0,exports.buildAddress)(shippingAddress,customerInfo)}return result};exports.buildPaymentAuthorizedResponse=buildPaymentAuthorizedResponse},{"../constants":27}],34:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.isObjectOrUndefined=exports.isObject=exports.isString=void 0;var isString=function isString(value){return typeof value==="string"};exports.isString=isString;var isObject=function isObject(value){return _typeof(value)==="object"&&value!==null};exports.isObject=isObject;var isObjectOrUndefined=function isObjectOrUndefined(value){return(0,exports.isObject)(value)||value===undefined};exports.isObjectOrUndefined=isObjectOrUndefined},{}],35:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var __rest=void 0&&(void 0).__rest||function(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]]}return t};Object.defineProperty(exports,"__esModule",{value:true});exports.buildWalletNonceRequest=exports.buildPaymentAuthorizedResponse=exports.buildAddress=exports.buildCouponCodeResponse=exports.buildShippingMethodResponse=exports.buildShippingAddressResponse=void 0;var buildShippingAddressResponse=function buildShippingAddressResponse(event){return{shippingAddress:{administrativeArea:event.administrativeArea||"",countryCode:event.countryCode||"",postalCode:event.postalCode||"",locality:event.locality||""}}};exports.buildShippingAddressResponse=buildShippingAddressResponse;var buildShippingMethodResponse=function buildShippingMethodResponse(event,shippingMethods){var result={shippingMethod:{}};if("identifier"in event){result.shippingMethod={id:event.identifier,label:event.label,detail:event.detail,amount:event.amount}}if("id"in event){var shippingMethod=(shippingMethods||[]).find(function(item){return item.id===event.id});result.shippingMethod={id:event.id,label:shippingMethod===null||shippingMethod===void 0?void 0:shippingMethod.label,detail:shippingMethod===null||shippingMethod===void 0?void 0:shippingMethod.detail,amount:shippingMethod===null||shippingMethod===void 0?void 0:shippingMethod.amount}}return result};exports.buildShippingMethodResponse=buildShippingMethodResponse;var buildCouponCodeResponse=function buildCouponCodeResponse(event){return{couponCode:Array.isArray(event)?event[0]:event}};exports.buildCouponCodeResponse=buildCouponCodeResponse;var buildAddress=function buildAddress(address,email){var result={};if("givenName"in address){var phoneticFamilyName=address.phoneticFamilyName,phoneticGivenName=address.phoneticGivenName,subLocality=address.subLocality,subAdministrativeArea=address.subAdministrativeArea,country=address.country,_address$givenName=address.givenName,givenName=_address$givenName===void 0?"":_address$givenName,_address$familyName=address.familyName,familyName=_address$familyName===void 0?"":_address$familyName,data=__rest(address,["phoneticFamilyName","phoneticGivenName","subLocality","subAdministrativeArea","country","givenName","familyName"]);result=_extends(_extends({},data),{name:"".concat(givenName," ").concat(familyName)})}if("name"in address){var sortingCode=address.sortingCode,_address$address=address.address1,address1=_address$address===void 0?"":_address$address,_address$address2=address.address2,address2=_address$address2===void 0?"":_address$address2,_address$address3=address.address3,address3=_address$address3===void 0?"":_address$address3,_data=__rest(address,["sortingCode","address1","address2","address3"]);result=_extends(_extends({},_data),{emailAddress:email,addressLines:[address1,address2,address3].filter(function(address){return address})})}return result};exports.buildAddress=buildAddress;var buildPaymentAuthorizedResponse=function buildPaymentAuthorizedResponse(event,nonceResponse,requireShippingAddress){var _a;var result={};if("token"in event){if(event.billingContact){result.billingAddress=(0,exports.buildAddress)(event.billingContact)}if(event.shippingContact){var shippingAddress=(0,exports.buildAddress)(event.shippingContact);if(requireShippingAddress){result.shippingAddress=shippingAddress}if(result.billingAddress){if(shippingAddress.emailAddress){result.billingAddress.emailAddress=shippingAddress.emailAddress}if(shippingAddress.phoneNumber){result.billingAddress.phoneNumber=shippingAddress.phoneNumber}}}result.source="apple_pay"}if("paymentMethodData"in event){if(event.shippingAddress){result.shippingAddress=(0,exports.buildAddress)(event.shippingAddress,event.email)}if((_a=event.paymentMethodData.info)===null||_a===void 0?void 0:_a.billingAddress){result.billingAddress=(0,exports.buildAddress)(event.paymentMethodData.info.billingAddress,event.email)}result.source="google_pay"}result.nonce=nonceResponse.nonce;return result};exports.buildPaymentAuthorizedResponse=buildPaymentAuthorizedResponse;var buildWalletNonceRequest=function buildWalletNonceRequest(event){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z;var result={};if("token"in event){result={applePayPaymentToken:event.token,zip:(_a=event.billingContact)===null||_a===void 0?void 0:_a.postalCode,line1:((_b=event.billingContact)===null||_b===void 0?void 0:_b.addressLines)&&((_c=event.billingContact)===null||_c===void 0?void 0:_c.addressLines[0]),line2:((_d=event.billingContact)===null||_d===void 0?void 0:_d.addressLines)&&((_e=event.billingContact)===null||_e===void 0?void 0:_e.addressLines[1]),city:(_f=event.billingContact)===null||_f===void 0?void 0:_f.locality,territory:(_g=event.billingContact)===null||_g===void 0?void 0:_g.administrativeArea,countryCode:(_h=event.billingContact)===null||_h===void 0?void 0:_h.countryCode,firstName:(_j=event.billingContact)===null||_j===void 0?void 0:_j.givenName,lastName:(_k=event.billingContact)===null||_k===void 0?void 0:_k.familyName}}if("paymentMethodData"in event){result={googlePayPaymentToken:event.paymentMethodData,zip:(_m=(_l=event.paymentMethodData.info)===null||_l===void 0?void 0:_l.billingAddress)===null||_m===void 0?void 0:_m.postalCode,line1:(_p=(_o=event.paymentMethodData.info)===null||_o===void 0?void 0:_o.billingAddress)===null||_p===void 0?void 0:_p.address1,line2:(_r=(_q=event.paymentMethodData.info)===null||_q===void 0?void 0:_q.billingAddress)===null||_r===void 0?void 0:_r.address2,city:(_t=(_s=event.paymentMethodData.info)===null||_s===void 0?void 0:_s.billingAddress)===null||_t===void 0?void 0:_t.locality,territory:(_v=(_u=event.paymentMethodData.info)===null||_u===void 0?void 0:_u.billingAddress)===null||_v===void 0?void 0:_v.administrativeArea,countryCode:(_x=(_w=event.paymentMethodData.info)===null||_w===void 0?void 0:_w.billingAddress)===null||_x===void 0?void 0:_x.countryCode,firstName:(_z=(_y=event.paymentMethodData.info)===null||_y===void 0?void 0:_y.billingAddress)===null||_z===void 0?void 0:_z.name}}return result};exports.buildWalletNonceRequest=buildWalletNonceRequest},{}],36:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var constants=__importStar(require("../constants"));var walletHelpers=__importStar(require("../helpers/wallet"));var applePayHelpers=__importStar(require("../helpers/applepay"));var localization_1=require("../helpers/localization");var common_1=require("../helpers/common");var ApplePay=function(){function ApplePay(sharedService){_classCallCheck(this,ApplePay);this.sharedService=sharedService;this.initialized=false;this.applePaySession=null;this.isApplePayQr=false}return _createClass(ApplePay,[{key:"initialize",value:function initialize(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee(){var _a,_b,walletRequest,_t;return _regenerator().w(function(_context){while(1)switch(_context.p=_context.n){case 0:if(!this.initialized){_context.n=1;break}return _context.a(2);case 1:_context.p=1;walletRequest=this.sharedService.getWalletRequest();if(!((_a=walletRequest.disableWallets)===null||_a===void 0?void 0:_a.applePay)){_context.n=2;break}return _context.a(2);case 2:if(!(!window.ApplePaySession||!ApplePaySession.supportsVersion(constants.APPLEPAY_VERSION)||!ApplePaySession.canMakePayments())){_context.n=3;break}this.isApplePayQr=true;if(walletRequest.enableApplePayQr){_context.n=3;break}return _context.a(2);case 3:_context.n=4;return(0,common_1.loadScript)(constants.APPLEPAY_SCRIPT_URL);case 4:if(!(window.ApplePaySession&&ApplePaySession.supportsVersion(constants.APPLEPAY_VERSION)&&ApplePaySession.canMakePayments())){_context.n=6;break}_context.n=5;return this.sharedService.walletApi.validateApplePay({domainName:(0,common_1.getSourceAppHostname)(),displayName:(_b=walletRequest.merchantName)===null||_b===void 0?void 0:_b.substring(0,64)},{requestPaymentSession:false});case 5:this.initialized=true;case 6:_context.n=8;break;case 7:_context.p=7;_t=_context.v;this.sharedService.handleError("APPLE_PAY",_t);case 8:return _context.a(2)}},_callee,this,[[1,7]])}))}},{key:"isReady",value:function isReady(){return this.initialized}},{key:"buildSession",value:function buildSession(){var paymentRequest=applePayHelpers.buildPaymentRequest(this.sharedService.getWalletRequest());this.applePaySession=new ApplePaySession(constants.APPLEPAY_VERSION,paymentRequest);return this.applePaySession}},{key:"startSession",value:function startSession(walletRequest){this.sharedService.updateWalletRequest(walletRequest||{},"init_wallet");this.handler()}},{key:"abortSession",value:function abortSession(){if(!this.applePaySession){return this.sharedService.handleError("APPLE_PAY",new Error("ApplePay session not found"))}try{this.applePaySession.abort();this.applePaySession=null}catch(error){this.sharedService.handleError("APPLE_PAY",error)}}},{key:"mount",value:function mount(locale,buttonOptions,applePayButtonOptions){var _this=this;var _a;var options=_extends(_extends({},buttonOptions),applePayButtonOptions);var container=document.createElement("div");container.id="applepay-button-container";var button=document.createElement("apple-pay-button");var type=options.type;if(options.type==="checkout"){type="check-out"}var color=!options.color||options.color==="default"?"black":options.color;button.setAttribute("buttonstyle",color);button.setAttribute("type",type||"buy");button.setAttribute("locale",(0,localization_1.getLanguageCode)(options.locale||locale));button.style.setProperty("cursor","pointer");button.onclick=function(){if(!options.onClick){return _this.startSession()}options.onClick({source:"apple_pay"})};container.appendChild(button);(0,common_1.setButtonProperties)(container,options);(_a=this.sharedService.buttonsContainer)===null||_a===void 0?void 0:_a.appendChild(container)}},{key:"handler",value:function handler(){var _this2=this;var domainName=(0,common_1.getSourceAppHostname)();if(constants.DOMAIN_BLACKLIST.includes(domainName)){return this.sharedService.handleError("WALLET",new Error(domainName+" is blacklisted. Please reach out GDP support."))}if(!window.ApplePaySession){return this.sharedService.handleError("APPLE_PAY",new Error("ApplePay session not found"))}this.sharedService.processCallbacks("wallet_button_click",{source:"apple_pay",isApplePayQr:this.isApplePayQr});var session=this.buildSession();var walletRequest=this.sharedService.getWalletRequest();session.onvalidatemerchant=function(event){return __awaiter(_this2,void 0,void 0,_regenerator().m(function _callee2(){var _a,applePaySession,_t2;return _regenerator().w(function(_context2){while(1)switch(_context2.p=_context2.n){case 0:_context2.p=0;_context2.n=1;return this.sharedService.walletApi.validateApplePay({domainName:domainName,validationUrl:event.validationURL,displayName:(_a=walletRequest.merchantName)===null||_a===void 0?void 0:_a.substring(0,64)},{requestPaymentSession:true});case 1:applePaySession=_context2.v;session.completeMerchantValidation(applePaySession);_context2.n=3;break;case 2:_context2.p=2;_t2=_context2.v;this.sharedService.handleError("APPLE_PAY",_t2);case 3:return _context2.a(2)}},_callee2,this,[[0,2]])}))};if(walletRequest.requireShippingAddress){if(this.sharedService.listenerCallbacks["shipping_address_change"]){session.onshippingcontactselected=function(event){var updateWith=function updateWith(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate,"shipping_address_change");session.completeShippingContactSelection({newTotal:applePayHelpers.buildTotal(walletRequest),newLineItems:applePayHelpers.buildLineItems(walletRequest),newShippingMethods:applePayHelpers.buildShippingMethods(walletRequest),errors:applePayHelpers.buildErrors(walletRequest)})};_this2.sharedService.processCallbacks("shipping_address_change",_extends(_extends({},walletHelpers.buildShippingAddressResponse(event.shippingContact)),{updateWith:updateWith}))}}if(this.sharedService.listenerCallbacks["shipping_method_change"]){session.onshippingmethodselected=function(event){var updateWith=function updateWith(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate,"shipping_method_change");session.completeShippingMethodSelection({newTotal:applePayHelpers.buildTotal(walletRequest),newLineItems:applePayHelpers.buildLineItems(walletRequest)})};_this2.sharedService.processCallbacks("shipping_method_change",_extends(_extends({},walletHelpers.buildShippingMethodResponse(event.shippingMethod,walletRequest.shippingMethods)),{updateWith:updateWith}))}}}if(this.sharedService.listenerCallbacks["payment_authorized"]){session.onpaymentauthorized=function(event){return __awaiter(_this2,void 0,void 0,_regenerator().m(function _callee3(){var _this3=this;var complete,nonceResponse,_t3;return _regenerator().w(function(_context3){while(1)switch(_context3.p=_context3.n){case 0:complete=function complete(walletRequestUpdate){_this3.sharedService.updateWalletRequest(walletRequestUpdate||{},"payment_authorized");var errors=applePayHelpers.buildErrors(walletRequest);var status=errors?ApplePaySession.STATUS_FAILURE:ApplePaySession.STATUS_SUCCESS;session.completePayment({status:status,errors:errors})};_context3.p=1;_context3.n=2;return this.sharedService.walletApi.getWalletNonce(walletHelpers.buildWalletNonceRequest(event.payment));case 2:nonceResponse=_context3.v;this.sharedService.processCallbacks("payment_authorized",_extends(_extends({},walletHelpers.buildPaymentAuthorizedResponse(event.payment,nonceResponse,walletRequest.requireShippingAddress)),{complete:complete}));_context3.n=4;break;case 3:_context3.p=3;_t3=_context3.v;this.sharedService.handleError("APPLE_PAY_NONCE",_t3);session.completePayment({status:ApplePaySession.STATUS_FAILURE,errors:applePayHelpers.buildWalletNonceError(_t3)});case 4:return _context3.a(2)}},_callee3,this,[[1,3]])}))}}if(this.sharedService.listenerCallbacks["close_wallet"]){session.oncancel=function(event){var _a;_this2.sharedService.processCallbacks("close_wallet",{source:"apple_pay",reason:(_a=event===null||event===void 0?void 0:event.sessionError)===null||_a===void 0?void 0:_a.code})}}if(walletRequest.supportCouponCode&&this.sharedService.listenerCallbacks["coupon_code_change"]){session.oncouponcodechanged=function(event){var updateWith=function updateWith(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate,"coupon_code_change");session.completeCouponCodeChange({newTotal:applePayHelpers.buildTotal(walletRequest),newLineItems:applePayHelpers.buildLineItems(walletRequest),newShippingMethods:applePayHelpers.buildShippingMethods(walletRequest),errors:applePayHelpers.buildErrors(walletRequest)})};_this2.sharedService.processCallbacks("coupon_code_change",_extends(_extends({},walletHelpers.buildCouponCodeResponse(event.couponCode)),{updateWith:updateWith}))}}session.begin()}}])}();exports["default"]=ApplePay},{"../constants":27,"../helpers/applepay":28,"../helpers/common":30,"../helpers/localization":32,"../helpers/wallet":35}],37:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var card_on_file_1=require("../helpers/card-on-file");var CardOnFile=function(){function CardOnFile(sharedService){_classCallCheck(this,CardOnFile);this.sharedService=sharedService;this.cardAgreementData=null}return _createClass(CardOnFile,[{key:"mount",value:function mount(locale,hideActionButtons,options){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee(){var _this=this;var actionHandler,agreement,_t;return _regenerator().w(function(_context){while(1)switch(_context.p=_context.n){case 0:_context.p=0;actionHandler=function actionHandler(value){return function(){var _a;_this.sharedService.postIFrameMessage({type:"card_on_file_set_flag",options:{value:value}});var container=(_a=_this.cardAgreementData)===null||_a===void 0?void 0:_a.container;if(container&&document.body.contains(container)){document.body.removeChild(container)}}};_context.n=1;return(0,card_on_file_1.getCardAgreement)(locale,hideActionButtons,options,actionHandler(true),actionHandler(false));case 1:agreement=_context.v;this.cardAgreementData=agreement;this.sharedService.on("card_on_file_show_agreement",function(){var _a;if((_a=_this.cardAgreementData)===null||_a===void 0?void 0:_a.container){document.body.appendChild(_this.cardAgreementData.container)}});_context.n=3;break;case 2:_context.p=2;_t=_context.v;this.sharedService.handleError("CARD_ON_FILE",_t);case 3:;case 4:return _context.a(2)}},_callee,this,[[0,2]])}))}},{key:"unmount",value:function unmount(){if(this.cardAgreementData){if(document.body.contains(this.cardAgreementData.container)){document.body.removeChild(this.cardAgreementData.container)}this.sharedService.off("card_on_file_show_agreement");this.cardAgreementData=null}}}])}();exports["default"]=CardOnFile},{"../helpers/card-on-file":29}],38:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var constants=__importStar(require("../constants"));var walletHelpers=__importStar(require("../helpers/wallet"));var googlePayHelpers=__importStar(require("../helpers/googlepay"));var localization_1=require("../helpers/localization");var common_1=require("../helpers/common");var GooglePay=function(){function GooglePay(sharedService){var _this=this;_classCallCheck(this,GooglePay);this.sharedService=sharedService;this.updateWithWrapper=function(callbackTrigger,resolve){var callbackIntent=constants.GOOGLE_PAY_INTENT_MAP[callbackTrigger];var eventType=constants.GOOGLE_PAY_EVENT_MAP[callbackTrigger];return function(walletRequestUpdate){_this.sharedService.updateWalletRequest(walletRequestUpdate,eventType);var walletRequest=_this.sharedService.getWalletRequest();var update={};var transactionInfo=googlePayHelpers.buildTransactionInfo(walletRequest);var error=googlePayHelpers.buildError(walletRequest,callbackIntent);if(transactionInfo){update.newTransactionInfo=transactionInfo}if(error){update.error=error}if(walletRequest.requireShippingAddress&&callbackTrigger!=="SHIPPING_OPTION"){update.newShippingOptionParameters=googlePayHelpers.buildShippingMethods(walletRequest)}if(callbackTrigger==="OFFER"){update.newOfferInfo=googlePayHelpers.buildOfferInfo(walletRequest)}resolve(update)}};this.completeWrapper=function(resolve){return function(walletRequestUpdate){_this.sharedService.updateWalletRequest(walletRequestUpdate||{},"payment_authorized");var walletRequest=_this.sharedService.getWalletRequest();var error=googlePayHelpers.buildError(walletRequest,"PAYMENT_AUTHORIZATION");resolve({transactionState:error?"ERROR":"SUCCESS",error:error})}};this.googlePayPaymentDataChangedHandler=function(intermediatePaymentData){return new Promise(function(resolve){var _a;var callbackTrigger=intermediatePaymentData.callbackTrigger;var callbackIntent=constants.GOOGLE_PAY_INTENT_MAP[callbackTrigger];var eventType=constants.GOOGLE_PAY_EVENT_MAP[callbackTrigger];var updateWith=_this.updateWithWrapper(callbackTrigger,resolve);var walletRequest=_this.sharedService.getWalletRequest();if(callbackTrigger==="INITIALIZE"&&!walletRequest.requireShippingAddress){return resolve({})}if(!_this.sharedService.listenerCallbacks[eventType]){return resolve({error:googlePayHelpers.buildMissedHandlerError(eventType,callbackIntent)})}if(callbackIntent==="SHIPPING_OPTION"&&intermediatePaymentData.shippingOptionData){return _this.sharedService.processCallbacks("shipping_method_change",_extends(_extends({},walletHelpers.buildShippingMethodResponse(intermediatePaymentData.shippingOptionData,walletRequest.shippingMethods)),{updateWith:updateWith}))}if(callbackIntent==="SHIPPING_ADDRESS"&&intermediatePaymentData.shippingAddress){return _this.sharedService.processCallbacks("shipping_address_change",_extends(_extends({},walletHelpers.buildShippingAddressResponse(intermediatePaymentData.shippingAddress)),{updateWith:updateWith}))}if(callbackIntent==="OFFER"&&((_a=intermediatePaymentData.offerData)===null||_a===void 0?void 0:_a.redemptionCodes)){if(intermediatePaymentData.offerData.redemptionCodes.length>1){return resolve({newOfferInfo:googlePayHelpers.buildOfferInfo(walletRequest),error:googlePayHelpers.buildDuplicateCouponCodeError(callbackIntent)})}return _this.sharedService.processCallbacks("coupon_code_change",_extends(_extends({},walletHelpers.buildCouponCodeResponse(intermediatePaymentData.offerData.redemptionCodes)),{updateWith:updateWith}))}var error=googlePayHelpers.buildPaymentDataChangedHandlerError(callbackTrigger);_this.sharedService.handleError("GOOGLE_PAY",error);resolve({error:error})})};this.googlePayPaymentAuthorizedHandler=function(paymentData){return new Promise(function(resolve){var complete=_this.completeWrapper(resolve);if(!_this.sharedService.listenerCallbacks["payment_authorized"]){return resolve({transactionState:"ERROR",error:googlePayHelpers.buildMissedHandlerError("payment_authorized","PAYMENT_AUTHORIZATION")})}_this.sharedService.walletApi.getWalletNonce(walletHelpers.buildWalletNonceRequest(paymentData)).then(function(nonceResponse){_this.sharedService.processCallbacks("payment_authorized",_extends(_extends({},walletHelpers.buildPaymentAuthorizedResponse(paymentData,nonceResponse)),{complete:complete}))})["catch"](function(error){_this.sharedService.handleError("GOOGLE_PAY_NONCE",error);resolve({transactionState:"ERROR",error:googlePayHelpers.buildWalletNonceError("PAYMENT_AUTHORIZATION",error)})})})};this.initialized=false;this.paymentsClient=null;this.googlePayValidationPayload=null}return _createClass(GooglePay,[{key:"initialize",value:function initialize(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee(){var _a,_b,_c,walletRequest,googlePayValidationPayload,paymentsClient,isReadyToPay,_t;return _regenerator().w(function(_context){while(1)switch(_context.p=_context.n){case 0:if(!this.initialized){_context.n=1;break}return _context.a(2);case 1:_context.p=1;walletRequest=this.sharedService.getWalletRequest();if(!((_a=walletRequest.disableWallets)===null||_a===void 0?void 0:_a.googlePay)){_context.n=2;break}return _context.a(2);case 2:_context.n=3;return(0,common_1.loadScript)(constants.GOOGLEPAY_SCRIPT_URL);case 3:if((_c=(_b=window.google)===null||_b===void 0?void 0:_b.payments)===null||_c===void 0?void 0:_c.api){_context.n=4;break}return _context.a(2);case 4:_context.n=5;return this.sharedService.walletApi.validateGooglePay({domain:document.location.hostname});case 5:googlePayValidationPayload=_context.v;if(!(!(googlePayValidationPayload===null||googlePayValidationPayload===void 0?void 0:googlePayValidationPayload.authJwt)||!googlePayValidationPayload.googleEnvironment)){_context.n=6;break}return _context.a(2);case 6:paymentsClient=this.buildPaymentsClient(walletRequest,googlePayValidationPayload.googleEnvironment);_context.n=7;return paymentsClient.isReadyToPay({apiVersion:constants.GOOGLEPAY_VERSION,apiVersionMinor:constants.GOOGLEPAY_VERSION_MINOR,allowedPaymentMethods:[googlePayHelpers.getBaseCardPaymentMethod(walletRequest)],existingPaymentMethodRequired:false});case 7:isReadyToPay=_context.v;if(isReadyToPay.result){_context.n=8;break}return _context.a(2);case 8:this.initialized=true;this.paymentsClient=paymentsClient;this.googlePayValidationPayload=googlePayValidationPayload;_context.n=10;break;case 9:_context.p=9;_t=_context.v;this.sharedService.handleError("GOOGLE_PAY",_t);case 10:return _context.a(2)}},_callee,this,[[1,9]])}))}},{key:"isReady",value:function isReady(){return this.initialized}},{key:"buildPaymentsClient",value:function buildPaymentsClient(walletRequest,googleEnvironment){var paymentDataCallbacks={onPaymentAuthorized:this.googlePayPaymentAuthorizedHandler};if(walletRequest.requireShippingAddress||walletRequest.supportCouponCode){paymentDataCallbacks.onPaymentDataChanged=this.googlePayPaymentDataChangedHandler}var paymentsClient=new window.google.payments.api.PaymentsClient({environment:googleEnvironment,merchantInfo:{merchantName:walletRequest.merchantName,merchantId:constants.GOOGLEPAY_MERCHANT_ID},paymentDataCallbacks:paymentDataCallbacks});return paymentsClient}},{key:"startSession",value:function startSession(walletRequest){this.sharedService.updateWalletRequest(walletRequest||{},"init_wallet");this.handler()}},{key:"mount",value:function mount(locale,buttonOptions,googlePayButtonOptions){var _this2=this;var _a;var options=_extends(_extends({},buttonOptions),googlePayButtonOptions);try{if(this.paymentsClient){var container=this.paymentsClient.createButton({buttonColor:options.color,buttonType:options.type,buttonSizeMode:"fill",buttonLocale:(0,localization_1.getLanguageCode)(options.locale||locale),allowedPaymentMethods:[googlePayHelpers.getBaseCardPaymentMethod(this.sharedService.getWalletRequest())],onClick:function onClick(event){if(event){event.stopPropagation()}if(!options.onClick){return _this2.startSession()}options.onClick({source:"google_pay"})}});container.id="googlepay-button-container";(0,common_1.setButtonProperties)(container,options);(_a=this.sharedService.buttonsContainer)===null||_a===void 0?void 0:_a.appendChild(container)}}catch(error){this.sharedService.handleError("GOOGLE_PAY",error)}}},{key:"handler",value:function handler(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee2(){var _a,domainName,paymentRequest,parsedError,_t2;return _regenerator().w(function(_context2){while(1)switch(_context2.p=_context2.n){case 0:domainName=document.location.hostname;if(!constants.DOMAIN_BLACKLIST.includes(domainName)){_context2.n=1;break}return _context2.a(2,this.sharedService.handleError("WALLET",new Error(domainName+" is blacklisted. Please reach out GDP support.")));case 1:if(this.paymentsClient){_context2.n=2;break}return _context2.a(2,this.sharedService.handleError("GOOGLE_PAY",new Error("GooglePay payments client not found")));case 2:if((_a=this.googlePayValidationPayload)===null||_a===void 0?void 0:_a.authJwt){_context2.n=3;break}return _context2.a(2,this.sharedService.handleError("GOOGLE_PAY",new Error("GooglePay auth JWT token not found")));case 3:this.sharedService.processCallbacks("wallet_button_click",{source:"google_pay"});paymentRequest=googlePayHelpers.buildPaymentRequest(this.sharedService.getWalletRequest(),this.sharedService.options.businessId,this.googlePayValidationPayload.authJwt);_context2.p=4;_context2.n=5;return this.paymentsClient.loadPaymentData(paymentRequest);case 5:_context2.n=7;break;case 6:_context2.p=6;_t2=_context2.v;parsedError=this.sharedService.parseError("GOOGLE_PAY",_t2);this.sharedService.trackError(parsedError);this.sharedService.processCallbacks("close_wallet",{source:"google_pay",reason:parsedError.message});case 7:return _context2.a(2)}},_callee2,this,[[4,6]])}))}}])}();exports["default"]=GooglePay},{"../constants":27,"../helpers/common":30,"../helpers/googlepay":31,"../helpers/localization":32,"../helpers/wallet":35}],39:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});var uuid_1=require("uuid");var jwt_decode_1=__importDefault(require("jwt-decode"));var constants=__importStar(require("../constants"));var common_1=require("../helpers/common");var paze_1=require("../helpers/paze");var localization_1=require("../helpers/localization");var Paze=function(){function Paze(sharedService){_classCallCheck(this,Paze);this.sharedService=sharedService;this.initialized=false}return _createClass(Paze,[{key:"initialize",value:function initialize(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee(){var _a,walletRequest,pazeMessageExists,options,_t;return _regenerator().w(function(_context){while(1)switch(_context.p=_context.n){case 0:if(!this.initialized){_context.n=1;break}return _context.a(2);case 1:_context.p=1;walletRequest=this.sharedService.getWalletRequest();if(!((_a=walletRequest.disableWallets)===null||_a===void 0?void 0:_a.paze)){_context.n=2;break}return _context.a(2);case 2:pazeMessageExists="customElements"in window&&!!customElements.get("paze-message");if(pazeMessageExists){_context.n=3;break}_context.n=3;return(0,common_1.loadScript)((0,paze_1.getPazeScriptUrl)());case 3:if(window.DIGITAL_WALLET_SDK){_context.n=4;break}throw new Error("Paze Wallet API is not available");case 4:options={client:{id:"46VM0VIBJ63520UZ7X6U14L-0rahMJIVUiE1MgKLDdBgyTXkE",name:walletRequest.merchantName,profileId:"GoDaddy"}};_context.n=5;return this.sharedService.walletApi.validatePaze();case 5:_context.n=6;return window.DIGITAL_WALLET_SDK.initialize(options);case 6:this.initialized=true;_context.n=8;break;case 7:_context.p=7;_t=_context.v;this.sharedService.handleError("PAZE",_t);case 8:return _context.a(2)}},_callee,this,[[1,7]])}))}},{key:"isReady",value:function isReady(){return this.initialized}},{key:"startSession",value:function startSession(walletRequest){this.sharedService.updateWalletRequest(walletRequest||{},"init_wallet");this.handler()}},{key:"mount",value:function mount(locale,buttonOptions,pazeButtonOptions){var _this=this;var _a;var options=_extends(_extends({},buttonOptions),pazeButtonOptions);var container=document.createElement("div");container.id="pazewallet-button-container";var button=document.createElement("button");button.setAttribute("type","button");button.setAttribute("lang",(0,localization_1.getLanguageCode)(options.locale||locale));if(options.color==="white"){button.style.setProperty("background-color","#FFFFFF");button.style.setProperty("background-image","url(".concat(constants.ASSETS_CDN_URL,"paze-logo-blue.svg)"))}else{button.style.setProperty("background-image","url(".concat(constants.ASSETS_CDN_URL,"paze-logo-white.svg)"));button.style.setProperty("background-color",options.color==="black"?"#151B33":"#0F42F8")}button.style.setProperty("background-position","center");button.style.setProperty("background-repeat","no-repeat");button.onclick=function(){if(!options.onClick){return _this.startSession()}options.onClick({source:"paze"})};container.appendChild(button);(0,common_1.setButtonProperties)(container,options);(_a=this.sharedService.buttonsContainer)===null||_a===void 0?void 0:_a.appendChild(container)}},{key:"handleError",value:function handleError(type,originalError){var parsedError=this.sharedService.parseError(type,originalError);this.sharedService.trackError(parsedError);this.sharedService.processCallbacks("close_wallet",{source:"paze",reason:parsedError.message})}},{key:"handler",value:function handler(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee2(){var _this2=this;var domainName,pazeSessionId,walletRequest,checkoutRequest,checkoutResult,decodedCheckoutResult,completeRequest,completeResult,nonceResponse,complete,_t2,_t3;return _regenerator().w(function(_context2){while(1)switch(_context2.p=_context2.n){case 0:this.sharedService.processCallbacks("wallet_button_click",{source:"paze"});domainName=(0,common_1.getSourceAppHostname)();if(!constants.DOMAIN_BLACKLIST.includes(domainName)){_context2.n=1;break}return _context2.a(2,this.handleError("WALLET",new Error(domainName+" is blacklisted. Please reach out GDP support.")));case 1:if(this.initialized){_context2.n=2;break}return _context2.a(2,this.handleError("PAZE",new Error("Paze Wallet is not initialized")));case 2:_context2.p=2;pazeSessionId=(0,uuid_1.v4)();walletRequest=this.sharedService.getWalletRequest();checkoutRequest=(0,paze_1.buildCheckoutRequest)(walletRequest,pazeSessionId);_context2.n=3;return window.DIGITAL_WALLET_SDK.checkout(checkoutRequest);case 3:checkoutResult=_context2.v;if(!(checkoutResult.result!=="COMPLETE"||!checkoutResult.checkoutResponse)){_context2.n=4;break}return _context2.a(2,this.sharedService.processCallbacks("close_wallet",{source:"paze"}));case 4:decodedCheckoutResult=(0,jwt_decode_1["default"])(checkoutResult.checkoutResponse);completeRequest=(0,paze_1.buildCompleteRequest)(walletRequest,pazeSessionId);_context2.n=5;return window.DIGITAL_WALLET_SDK.complete(completeRequest);case 5:completeResult=_context2.v;_context2.p=6;_context2.n=7;return this.sharedService.walletApi.getWalletNonce((0,paze_1.buildWalletNonceRequest)(decodedCheckoutResult,completeResult,pazeSessionId));case 7:nonceResponse=_context2.v;complete=function complete(walletRequestUpdate){_this2.sharedService.updateWalletRequest(walletRequestUpdate||{},"payment_authorized")};this.sharedService.processCallbacks("payment_authorized",_extends(_extends({},(0,paze_1.buildPaymentAuthorizedResponse)(decodedCheckoutResult,nonceResponse,walletRequest.requireShippingAddress)),{complete:complete}));_context2.n=9;break;case 8:_context2.p=8;_t2=_context2.v;return _context2.a(2,this.handleError("PAZE_NONCE",_t2));case 9:_context2.n=11;break;case 10:_context2.p=10;_t3=_context2.v;return _context2.a(2,this.handleError("PAZE",_t3));case 11:return _context2.a(2)}},_callee2,this,[[6,8],[2,10]])}))}}])}();exports["default"]=Paze},{"../constants":27,"../helpers/common":30,"../helpers/localization":32,"../helpers/paze":33,"jwt-decode":2,uuid:8}],40:[function(require,module,exports){"use strict";function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __importDefault=void 0&&(void 0).__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});var uuid_1=require("uuid");var wallet_api_1=__importDefault(require("../services/wallet-api"));var helpers=__importStar(require("../helpers/common"));var Shared=function(){function Shared(options,walletRequest){var _this=this;_classCallCheck(this,Shared);this.createMessageChannel=function(options){_this.messageChannel=new MessageChannel;_this.messageChannel.port1.onmessage=function(event){var message=helpers.parseMessage(event);if(!message){return}_this.processCallbacks(message.type,message)};_this.postIFrameMessage({type:"init",options:options},_this.messageChannel.port2)};this.options=options;this.options.sessionId=options.sessionId||(0,uuid_1.v4)();this.listenerCallbacks={};this.iFrame=null;this.messageChannel=null;this.buttonsContainer=null;this.walletRequest=walletRequest||helpers.createDefaultWalletRequest();this.walletApi=wallet_api_1["default"].getInstance(options);if(!options.businessId||typeof options.businessId!=="string"||options.businessId.trim()===""){throw new Error("businessId is required and cannot be empty")}}return _createClass(Shared,[{key:"on",value:function on(eventName,callback){this.listenerCallbacks[eventName]=callback}},{key:"off",value:function off(eventName){this.listenerCallbacks[eventName]=null}},{key:"parseError",value:function parseError(type,originalError){var error=_typeof(originalError)==="object"&&originalError.statusMessage?{message:originalError.statusMessage,name:originalError.statusCode,type:type}:_typeof(originalError)==="object"&&originalError.reason?{message:originalError.reason,name:"Error",type:type}:originalError instanceof Error?{message:originalError.message,name:originalError.name,type:type}:typeof originalError==="string"?{message:originalError,type:type}:_extends(_extends({},originalError),{type:type});return error}},{key:"trackError",value:function trackError(error,additionalProperties){var _a;(_a=window.PoyntCollectUtilities)===null||_a===void 0?void 0:_a.log({eventName:"gdp.collect.error",customProperties:_extends(_extends(_extends({},this.options),{errorType:error.type,errorMessage:error.message||"Unknown error"}),additionalProperties)});console.error(error,additionalProperties)}},{key:"handleError",value:function handleError(type,originalError,additionalProperties){var error=this.parseError(type,originalError);this.trackError(error,additionalProperties)}},{key:"postIFrameMessage",value:function postIFrameMessage(data,port){var _a,_b;var stringifiedData=JSON.stringify(data);(_b=(_a=this.iFrame)===null||_a===void 0?void 0:_a.contentWindow)===null||_b===void 0?void 0:_b.postMessage(stringifiedData,"https://cdn.poynt.net",port?[port]:undefined)}},{key:"getWalletRequest",value:function getWalletRequest(){return this.walletRequest}},{key:"updateWalletRequest",value:function updateWalletRequest(update,event){var _a;var request=this.walletRequest;request.error=update.error;if(event==="payment_authorized"){return}if(update.total){request.total=update.total}if(update.lineItems){request.lineItems=update.lineItems}if(event!=="shipping_method_change"&&((_a=update.shippingMethods)===null||_a===void 0?void 0:_a.length)){request.shippingMethods=update.shippingMethods}if((event==="init_wallet"||event==="coupon_code_change")&&update.couponCode){request.couponCode=update.couponCode}}},{key:"processCallbacks",value:function processCallbacks(eventType,data){try{if(!this.listenerCallbacks[eventType]){console.warn("Callback for event type ".concat(eventType," not found"));return}this.listenerCallbacks[eventType](data)}catch(error){this.handleError("CLIENT_INTEGRATION",error,{eventType:eventType});throw error}}},{key:"mountPaymentForm",value:function mountPaymentForm(domElement,document,options){var _this2=this;var container=document.getElementById(domElement);var _initEventListener=function initEventListener(event){var _a;if(event.origin!=="https://cdn.poynt.net"){return}var message=helpers.parseMessage(event);var sessionId=(_a=message===null||message===void 0?void 0:message.data)===null||_a===void 0?void 0:_a.sessionId;if((message===null||message===void 0?void 0:message.type)!=="load"||sessionId!==options.sessionId){return}_this2.createMessageChannel(options);window.removeEventListener("message",_initEventListener)};window.addEventListener("message",_initEventListener);this.iFrame=helpers.createIFrame(options);container===null||container===void 0?void 0:container.appendChild(this.iFrame)}},{key:"mountButtonsContainer",value:function mountButtonsContainer(domElement,document,options){var _a;var container=document.getElementById(domElement);var buttonsContainer=document.createElement("div");buttonsContainer.setAttribute("id","wallet-buttons-container");buttonsContainer.setAttribute("class",((_a=options.buttonsContainerOptions)===null||_a===void 0?void 0:_a.className)||"");helpers.setButtonsContainerProperties(buttonsContainer,options.buttonsContainerOptions);container===null||container===void 0?void 0:container.appendChild(buttonsContainer);this.buttonsContainer=buttonsContainer}},{key:"unmount",value:function unmount(domElement,document){if(this.messageChannel){this.messageChannel.port1.close();this.messageChannel.port2.close();this.messageChannel=null}if(document&&domElement){var form=document.getElementById(domElement);if(this.iFrame){if(form===null||form===void 0?void 0:form.contains(this.iFrame)){form.removeChild(this.iFrame)}this.iFrame=null}if(this.buttonsContainer){if(form===null||form===void 0?void 0:form.contains(this.buttonsContainer)){form.removeChild(this.buttonsContainer)}this.buttonsContainer=null}}}}])}();exports["default"]=Shared},{"../helpers/common":30,"../services/wallet-api":42,uuid:8}],41:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var constants_1=require("../constants");var Utilities=function(){function Utilities(){_classCallCheck(this,Utilities);this.loaded=false;this.loadingPromise=null;this.iFrame=null}return _createClass(Utilities,[{key:"isMounted",value:function isMounted(){return!!(this.loaded&&this.iFrame&&document.body.contains(this.iFrame))}},{key:"createIFrame",value:function createIFrame(){var iFrame=document.createElement("iframe");iFrame.setAttribute("name",constants_1.UTILITIES_IFRAME_NAME);iFrame.setAttribute("id",constants_1.UTILITIES_IFRAME_NAME);iFrame.setAttribute("style","display: none");iFrame.setAttribute("src","https://cdn.poynt.net/collect/utilities/index.html");return iFrame}},{key:"mount",value:function mount(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee(){var _this=this;var existingIFrame,promise;return _regenerator().w(function(_context){while(1)switch(_context.n){case 0:if(!this.loadingPromise){_context.n=1;break}return _context.a(2,this.loadingPromise);case 1:existingIFrame=document.getElementById(constants_1.UTILITIES_IFRAME_NAME);if(!(existingIFrame&&document.body.contains(existingIFrame))){_context.n=2;break}this.iFrame=existingIFrame;this.loaded=true;return _context.a(2);case 2:promise=new Promise(function(resolve,reject){_this.iFrame=_this.createIFrame();var timeout=setTimeout(function(){_this.loadingPromise=null;_this.iFrame=null;_this.loaded=false;reject(new Error("Timeout mounting utilities iFrame"))},constants_1.DEFAULT_TIMEOUT);_this.iFrame.onload=function(){_this.loadingPromise=null;_this.loaded=true;clearTimeout(timeout);resolve()};document.body.appendChild(_this.iFrame)});this.loadingPromise=promise;return _context.a(2,promise)}},_callee,this)}))}},{key:"postMessage",value:function postMessage(payload){var _a;if(!((_a=this.iFrame)===null||_a===void 0?void 0:_a.contentWindow)){console.warn("Utilities iFrame not found");return}var eventData={type:"log",payload:payload};this.iFrame.contentWindow.postMessage(JSON.stringify(eventData),"https://cdn.poynt.net")}},{key:"log",value:function log(payload){var _this2=this;if(!this.isMounted()){this.mount().then(function(){_this2.postMessage(payload)})["catch"](function(error){console.error("Error mounting utilities iFrame",error)})}else{this.postMessage(payload)}}}],[{key:"getInstance",value:function getInstance(){if(!Utilities.instance){Utilities.instance=new Utilities}return Utilities.instance}}])}();Utilities.instance=null;exports["default"]=Utilities},{"../constants":27}],42:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var __createBinding=void 0&&(void 0).__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function get(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=void 0&&(void 0).__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=void 0&&(void 0).__importStar||function(){var _ownKeys=function ownKeys(o){_ownKeys=Object.getOwnPropertyNames||function(o){var ar=[];for(var k in o)if(Object.prototype.hasOwnProperty.call(o,k))ar[ar.length]=k;return ar};return _ownKeys(o)};return function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k=_ownKeys(mod),i=0;i<k.length;i++)if(k[i]!=="default")__createBinding(result,mod,k[i]);__setModuleDefault(result,mod);return result}}();var __awaiter=void 0&&(void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});var constants=__importStar(require("../constants"));var common_1=require("../helpers/common");var WalletApi=function(){function WalletApi(poyntCollectOptions){_classCallCheck(this,WalletApi);this.loaded=false;this.loadingPromise=null;this.poyntCollectOptions=poyntCollectOptions;this.iFrame=null}return _createClass(WalletApi,[{key:"isMounted",value:function isMounted(){return!!(this.loaded&&this.iFrame&&document.body.contains(this.iFrame))}},{key:"createIFrame",value:function createIFrame(){var iFrame=document.createElement("iframe");iFrame.setAttribute("name",constants.WALLET_API_IFRAME_NAME);iFrame.setAttribute("id",constants.WALLET_API_IFRAME_NAME);iFrame.setAttribute("style","display: none");iFrame.setAttribute("src","https://cdn.poynt.net/collect/wallet-api/index.html");return iFrame}},{key:"mount",value:function mount(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee(){var _this=this;var existingIFrame,promise;return _regenerator().w(function(_context){while(1)switch(_context.n){case 0:if(!this.loadingPromise){_context.n=1;break}return _context.a(2,this.loadingPromise);case 1:existingIFrame=document.getElementById(constants.WALLET_API_IFRAME_NAME);if(!(existingIFrame&&document.body.contains(existingIFrame))){_context.n=2;break}this.iFrame=existingIFrame;this.loaded=true;return _context.a(2);case 2:promise=new Promise(function(resolve,reject){_this.iFrame=_this.createIFrame();var timeout=setTimeout(function(){_this.loadingPromise=null;_this.iFrame=null;_this.loaded=false;reject(new Error("Timeout mounting wallet API iFrame"))},constants.DEFAULT_TIMEOUT);_this.iFrame.onload=function(){_this.loadingPromise=null;_this.loaded=true;clearTimeout(timeout);resolve()};document.body.appendChild(_this.iFrame)});this.loadingPromise=promise;return _context.a(2,promise)}},_callee,this)}))}},{key:"postMessage",value:function postMessage(requestEvent,reponseSuccessEvent,responseFailEvent,payload,options){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee2(){var _this2=this;return _regenerator().w(function(_context2){while(1)switch(_context2.n){case 0:return _context2.a(2,new Promise(function(resolve,reject){var _a;var messageChannel=new MessageChannel;var onComplete=function onComplete(){clearTimeout(timeout);messageChannel.port1.close();messageChannel.port2.close()};var timeout=setTimeout(function(){onComplete();reject(new Error("Timeout posting message ".concat(requestEvent)))},constants.DEFAULT_TIMEOUT);messageChannel.port1.onmessage=function(event){var message=(0,common_1.parseMessage)(event);onComplete();if(!message){return reject(new Error("Invalid message"))}if(message.type===reponseSuccessEvent){return resolve(message.data)}if(message.type===responseFailEvent){return reject(message.data)}console.error("Invalid message type: ",message.type);return reject(new Error("Invalid message type"))};if(!((_a=_this2.iFrame)===null||_a===void 0?void 0:_a.contentWindow)){return reject(new Error("iFrame not found"))}_this2.iFrame.contentWindow.postMessage(JSON.stringify(_extends({type:requestEvent,payload:payload,options:options},_this2.poyntCollectOptions)),"https://cdn.poynt.net",[messageChannel.port2])}))}},_callee2)}))}},{key:"mountAndPostMessage",value:function mountAndPostMessage(requestEvent,reponseSuccessEvent,responseFailEvent,payload,options){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee3(){return _regenerator().w(function(_context3){while(1)switch(_context3.n){case 0:if(this.isMounted()){_context3.n=1;break}_context3.n=1;return this.mount();case 1:return _context3.a(2,this.postMessage(requestEvent,reponseSuccessEvent,responseFailEvent,payload,options))}},_callee3,this)}))}},{key:"validateApplePay",value:function validateApplePay(payload,options){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee4(){return _regenerator().w(function(_context4){while(1)switch(_context4.n){case 0:return _context4.a(2,this.mountAndPostMessage("op_validate_applepay","validate_applepay","validate_applepay_error",payload,options))}},_callee4,this)}))}},{key:"validateGooglePay",value:function validateGooglePay(payload){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee5(){return _regenerator().w(function(_context5){while(1)switch(_context5.n){case 0:return _context5.a(2,this.mountAndPostMessage("op_validate_googlepay","validate_googlepay","validate_googlepay_error",payload))}},_callee5,this)}))}},{key:"validatePaze",value:function validatePaze(){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee6(){return _regenerator().w(function(_context6){while(1)switch(_context6.n){case 0:return _context6.a(2,this.mountAndPostMessage("op_validate_paze","validate_paze","validate_paze_error"))}},_callee6,this)}))}},{key:"getWalletNonce",value:function getWalletNonce(payload){return __awaiter(this,void 0,void 0,_regenerator().m(function _callee7(){return _regenerator().w(function(_context7){while(1)switch(_context7.n){case 0:return _context7.a(2,this.mountAndPostMessage("op_get_wallet_nonce","wallet_nonce","wallet_nonce_error",payload))}},_callee7,this)}))}}],[{key:"getInstance",value:function getInstance(poyntCollectOptions){if(!WalletApi.instance){WalletApi.instance=new WalletApi(poyntCollectOptions)}return WalletApi.instance}}])}();WalletApi.instance=null;exports["default"]=WalletApi},{"../constants":27,"../helpers/common":30}]},{},[24]);
